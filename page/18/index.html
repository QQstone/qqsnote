<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.1">
  <link rel="apple-touch-icon" sizes="180x180" href="/qqsnote/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/qqsnote/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/qqsnote/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/qqsnote/images/logo.svg" color="#222">

<link rel="stylesheet" href="/qqsnote/css/main.css">


<link rel="stylesheet" href="/qqsnote/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"qqstone.github.io","root":"/qqsnote/","scheme":"Muse","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta property="og:type" content="website">
<meta property="og:title" content="QQs&#39;Note">
<meta property="og:url" content="http://qqstone.github.io/qqsnote/page/18/index.html">
<meta property="og:site_name" content="QQs&#39;Note">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="QQs">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://qqstone.github.io/qqsnote/page/18/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'en'
  };
</script>

  <title>QQs'Note</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/qqsnote/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">QQs'Note</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/qqsnote/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/qqsnote/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://qqstone.github.io/qqsnote/2020/08/31/ASPandSPA/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/qqsnote/images/avatar.gif">
      <meta itemprop="name" content="QQs">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="QQs'Note">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/qqsnote/2020/08/31/ASPandSPA/" class="post-title-link" itemprop="url">ASP和SPA</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2020-08-31 10:58:10" itemprop="dateCreated datePublished" datetime="2020-08-31T10:58:10+08:00">2020-08-31</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2025-06-08 20:33:40" itemprop="dateModified" datetime="2025-06-08T20:33:40+08:00">2025-06-08</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/qqsnote/categories/%E5%90%8E%E7%AB%AF%E6%8A%80%E6%9C%AF/" itemprop="url" rel="index"><span itemprop="name">后端技术</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>课外：<a target="_blank" rel="noopener" href="https://docs.microsoft.com/zh-cn/dotnet/architecture/modern-web-apps-azure/choose-between-traditional-web-and-single-page-apps">关于传统web app和SPA的选择</a></p>
<p>将单页面应用植入到ASP.Net<br></p>
<h4 id="方式一：项目模板和spa中间件："><a href="#方式一：项目模板和spa中间件：" class="headerlink" title="方式一：项目模板和spa中间件："></a>方式一：项目模板和spa中间件：</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">% 安装spa template pack</span><br><span class="line">dotnet new -i Microsoft.DotNet.Web.Spa.ProjectTemplates</span><br><span class="line">% 使用模板创建项目 </span><br><span class="line">dotnet new --list</span><br><span class="line">dotnet new angular -n MyDotnetNgProject</span><br></pre></td></tr></table></figure>
<p>angular is short for template”<span>ASP.NET</span> Core with Angular”, -n 指定项目名称，键入dotnet new —help查看选项参数说明。<br>项目大致结构<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">│   appsettings.json</span><br><span class="line">│   MyDotNetNgProject.csproj</span><br><span class="line">│   Program.cs</span><br><span class="line">│   Startup.cs</span><br><span class="line">├───ClientApp</span><br><span class="line">│   │   angular.json</span><br><span class="line">│   │   package.json</span><br><span class="line">│   │   tsconfig.json</span><br><span class="line">│   │   tslint.json</span><br><span class="line">│   ├───e2e</span><br><span class="line">│   │   └───src</span><br><span class="line">│   └───src</span><br><span class="line">│       ├───app</span><br><span class="line">│       │   ├───counter</span><br><span class="line">│       │   ├───fetch-data</span><br><span class="line">│       │   ├───home</span><br><span class="line">│       │   └───nav-menu</span><br><span class="line">│       ├───assets</span><br><span class="line">│       └───environments</span><br><span class="line">├───Controllers</span><br><span class="line">├───obj</span><br><span class="line">├───Pages</span><br><span class="line">├───Properties</span><br><span class="line">│       launchSettings.json</span><br><span class="line">└───wwwroot</span><br></pre></td></tr></table></figure><br>整个前端项目以ClientApp目录为根目录，在ASP的Startup.Configure中调用spa中间件,如下<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">app.UseSpa(spa &#x3D;&gt; &#123;</span><br><span class="line">    &#x2F;&#x2F; To learn more about options for serving an Angular SPA from ASP.NET Core,</span><br><span class="line">    &#x2F;&#x2F; see https:&#x2F;&#x2F;go.microsoft.com&#x2F;fwlink&#x2F;?linkid&#x3D;864501</span><br><span class="line"></span><br><span class="line">    spa.Options.SourcePath &#x3D; &quot;ClientApp&quot;;</span><br><span class="line"></span><br><span class="line">    if (env.IsDevelopment())</span><br><span class="line">    &#123;</span><br><span class="line">        spa.UseAngularCliServer(npmScript: &quot;start&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p>
<h4 id="方式二：前端发布到wwwroot，使用静态文件和默认页"><a href="#方式二：前端发布到wwwroot，使用静态文件和默认页" class="headerlink" title="方式二：前端发布到wwwroot，使用静态文件和默认页"></a>方式二：前端发布到wwwroot，使用静态文件和默认页</h4><p>Startup.cs<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">public void Configure(IApplicationBuilder app, IWebHostEnvironment env)</span><br><span class="line">&#123;</span><br><span class="line">    app.UseDefaultFiles();</span><br><span class="line">    app.UseStaticFiles();</span><br><span class="line"></span><br><span class="line">    app.UseRouting();</span><br><span class="line">    app.UseEndpoints(endpoints &#x3D;&gt;</span><br><span class="line">    &#123;</span><br><span class="line">        endpoints.MapControllerRoute(</span><br><span class="line">            name: &quot;default&quot;,</span><br><span class="line">            pattern: &quot;&#123;controller&#x3D;Home&#125;&#x2F;&#123;action&#x3D;Index&#125;&#x2F;&#123;id?&#125;&quot;);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>UseDefaultFiles的搜索规则是<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">default.htm</span><br><span class="line">default.html</span><br><span class="line">index.htm</span><br><span class="line">index.html</span><br></pre></td></tr></table></figure><br>另外可以使用DefaultFilesOptions添加自定义默认页，详见 <a target="_blank" rel="noopener" href="https://docs.microsoft.com/zh-cn/aspnet/core/fundamentals/static-files?view=aspnetcore-3.1">ASP.NET Core 中的静态文件</a></p>
<h4 id="Trouble-Shooting"><a href="#Trouble-Shooting" class="headerlink" title="Trouble Shooting"></a>Trouble Shooting</h4><blockquote>
<p>Issue: The Angular CLI process did not start listening for requests within the timeout period of 0 seconds.</p>
</blockquote>
<p>当前的angular模板是基于Angular 8.2.12(记于2020.8.28)，在迁移ng9，ng10项目时出现上述问题。</p>
<p>见<a target="_blank" rel="noopener" href="https://github.com/angular/angular-cli/issues/16961">issue#16961</a></p>
<p>较深入的分析<a target="_blank" rel="noopener" href="https://github.com/dotnet/aspnetcore/issues/18062">issue#18062</a></p>
<p>workaround: edit start script<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;start&quot;: &quot;echo start &amp;&amp; ng serve  --host 0.0.0.0&quot;,</span><br></pre></td></tr></table></figure></p>
<blockquote>
<p>路由问题</p>
</blockquote>
<h4 id="拓展"><a href="#拓展" class="headerlink" title="拓展"></a>拓展</h4><p><a target="_blank" rel="noopener" href="https://docs.microsoft.com/zh-cn/aspnet/core/security/authentication/identity-api-authorization?view=aspnetcore-3.1">ASP.NET Core 上的单页面应用的身份验证简介</a><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dotnet new angular -o AspNgIndividualAuthProj -au Individual</span><br></pre></td></tr></table></figure><br>Caution! 模板生成同时提供认证授权功能的应用，具体是使用一个叫<a target="_blank" rel="noopener" href="https://www.cnblogs.com/sheng-jie/p/9430920.html">IdentityServer</a>的框架，IdentityServer封装了提供重定向endpint，生成JWT令牌，校验令牌等功能。 通常情况下，后台服务应对接独立的SSO，下面的大部分内容对此的可参考性很有限</p>
<h4 id="MSAL-Angular-Net-Core-AD-B2C"><a href="#MSAL-Angular-Net-Core-AD-B2C" class="headerlink" title="MSAL + Angular + .Net Core + AD B2C"></a>MSAL + Angular + .Net Core + AD B2C</h4><p>Microsoft Authentication Library(微软身份认证库MSAL)</p>
<p>微软栗子真多—&gt; <a target="_blank" rel="noopener" href="https://github.com/Azure-Samples/active-directory-b2c-javascript-angular-spa">Azure-Sample</a><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i msal @azure&#x2F;msal-angular -save-dev</span><br></pre></td></tr></table></figure><br>引入MSAL模块 @app.module<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line">import &#123; Configuration &#125; from &#39;msal&#39;;</span><br><span class="line">import &#123;</span><br><span class="line">  MsalModule,</span><br><span class="line">  MsalInterceptor,</span><br><span class="line">  MSAL_CONFIG,</span><br><span class="line">  MSAL_CONFIG_ANGULAR,</span><br><span class="line">  MsalService,</span><br><span class="line">  MsalAngularConfiguration</span><br><span class="line">&#125; from &#39;@azure&#x2F;msal-angular&#39;;</span><br><span class="line"></span><br><span class="line">import &#123; msalConfig, msalAngularConfig &#125; from &#39;.&#x2F;app-config&#39;;</span><br><span class="line">import &#123; AppRoutingModule &#125; from &#39;.&#x2F;app-routing.module&#39;;</span><br><span class="line">import &#123; ProfileComponent &#125; from &#39;.&#x2F;profile&#x2F;profile.component&#39;;</span><br><span class="line"></span><br><span class="line">function MSALConfigFactory(): Configuration &#123;</span><br><span class="line">  return msalConfig;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function MSALAngularConfigFactory(): MsalAngularConfiguration &#123;</span><br><span class="line">  return msalAngularConfig;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@NgModule(&#123;</span><br><span class="line">  declarations: [</span><br><span class="line">    AppComponent,</span><br><span class="line">    HomeComponent,</span><br><span class="line">    ProfileComponent,</span><br><span class="line">  ],</span><br><span class="line">  imports: [</span><br><span class="line">    ...</span><br><span class="line">    MsalModule</span><br><span class="line">  ],</span><br><span class="line">  providers: [</span><br><span class="line">    &#123;</span><br><span class="line">      provide: HTTP_INTERCEPTORS,</span><br><span class="line">      useClass: MsalInterceptor,</span><br><span class="line">      multi: true</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      provide: MSAL_CONFIG,</span><br><span class="line">      useFactory: MSALConfigFactory</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      provide: MSAL_CONFIG_ANGULAR,</span><br><span class="line">      useFactory: MSALAngularConfigFactory</span><br><span class="line">    &#125;,</span><br><span class="line">    MsalService</span><br><span class="line">  ],</span><br><span class="line">  bootstrap: [AppComponent]</span><br><span class="line">&#125;)</span><br><span class="line">export class AppModule &#123; &#125;</span><br></pre></td></tr></table></figure><br>另 使用oidc-client的栗子参考<a href="/qqsnote/2020/11/20/oidc-client/" title="oidc-client">oidc-client</a></p>
<h4 id="关于-csproj"><a href="#关于-csproj" class="headerlink" title="关于.csproj"></a>关于.csproj</h4><p>参考：<a target="_blank" rel="noopener" href="https://blog.walterlv.com/post/understand-the-csproj.html">理解 C# 项目 csproj 文件格式的本质和编译流程</a><br><img src="https://blog.walterlv.com/static/posts/2018-05-07-08-41-22.png" alt=""></p>
<ul>
<li>PropertyGroup, 声明编译过程中用到的变量，如一些路径，所谓的group，为了增强可读性，而将一组变量放在一个PropertyGroup中，其他的再放一个PropertyGroup<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;PropertyGroup&gt;</span><br><span class="line">  ...</span><br><span class="line">  &lt;SpaRoot&gt;ClientApp\&lt;&#x2F;SpaRoot&gt;</span><br><span class="line">&lt;&#x2F;PropertyGroup&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
<li>ItemGroup, 顾名思义，存放集合的项，一个group中各项属性名相同，可以认为是类型为XX(即属性名)的一个集合，下例是第三方的package，另外也可以放其他模块所需的任意内容，用相应的属性标识出<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;ItemGroup&gt;</span><br><span class="line">  &lt;PackageReference Include&#x3D;&quot;EntityFrameworkCore.SqlServer.HierarchyId&quot; Version&#x3D;&quot;1.1.1&quot; &#x2F;&gt;</span><br><span class="line">  &lt;PackageReference Include&#x3D;&quot;Microsoft.AspNetCore.Mvc.NewtonsoftJson&quot; Version&#x3D;&quot;3.1.2&quot; &#x2F;&gt;</span><br><span class="line">  &lt;PackageReference Include&#x3D;&quot;Microsoft.AspNetCore.SpaServices.Extensions&quot; Version&#x3D;&quot;3.1.7&quot; &#x2F;&gt;</span><br><span class="line">  &lt;PackageReference Include&#x3D;&quot;Microsoft.EntityFrameworkCore.SqlServer&quot; Version&#x3D;&quot;3.1.7&quot; &#x2F;&gt;</span><br><span class="line">&lt;&#x2F;ItemGroup&gt;</span><br></pre></td></tr></table></figure></li>
<li>Target<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">  &lt;Target Name&#x3D;&quot;DebugEnsureNodeEnv&quot; BeforeTargets&#x3D;&quot;Build&quot; Condition&#x3D;&quot; &#39;$(Configuration)&#39; &#x3D;&#x3D; &#39;Debug&#39; And !Exists(&#39;$(SpaRoot)node_modules&#39;) &quot;&gt;</span><br><span class="line">  &lt;!-- Ensure Node.js is installed --&gt;</span><br><span class="line">  &lt;Exec Command&#x3D;&quot;node --version&quot; ContinueOnError&#x3D;&quot;true&quot;&gt;</span><br><span class="line">    &lt;Output TaskParameter&#x3D;&quot;ExitCode&quot; PropertyName&#x3D;&quot;ErrorCode&quot; &#x2F;&gt;</span><br><span class="line">  &lt;&#x2F;Exec&gt;</span><br><span class="line">  &lt;Error Condition&#x3D;&quot;&#39;$(ErrorCode)&#39; !&#x3D; &#39;0&#39;&quot; Text&#x3D;&quot;Node.js is required to build and run this project. To continue, please install Node.js from https:&#x2F;&#x2F;nodejs.org&#x2F;, and then restart your command prompt or IDE.&quot; &#x2F;&gt;</span><br><span class="line">  &lt;Message Importance&#x3D;&quot;high&quot; Text&#x3D;&quot;Restoring dependencies using &#39;npm&#39;. This may take several minutes...&quot; &#x2F;&gt;</span><br><span class="line">  &lt;Exec WorkingDirectory&#x3D;&quot;$(SpaRoot)&quot; Command&#x3D;&quot;npm install&quot; &#x2F;&gt;</span><br><span class="line">&lt;&#x2F;Target&gt;</span><br><span class="line"></span><br><span class="line">&lt;Target Name&#x3D;&quot;PublishRunWebpack&quot; AfterTargets&#x3D;&quot;ComputeFilesToPublish&quot;&gt;</span><br><span class="line">  &lt;!-- As part of publishing, ensure the JS resources are freshly built in production mode --&gt;</span><br><span class="line">  &lt;Exec WorkingDirectory&#x3D;&quot;$(SpaRoot)&quot; Command&#x3D;&quot;npm install&quot; &#x2F;&gt;</span><br><span class="line">  &lt;Exec WorkingDirectory&#x3D;&quot;$(SpaRoot)&quot; Command&#x3D;&quot;npm run build -- --prod&quot; &#x2F;&gt;</span><br><span class="line">  &lt;Exec WorkingDirectory&#x3D;&quot;$(SpaRoot)&quot; Command&#x3D;&quot;npm run build:ssr -- --prod&quot; Condition&#x3D;&quot; &#39;$(BuildServerSideRenderer)&#39; &#x3D;&#x3D; &#39;true&#39; &quot; &#x2F;&gt;</span><br><span class="line"></span><br><span class="line">  &lt;!-- Include the newly-built files in the publish output --&gt;</span><br><span class="line">  &lt;ItemGroup&gt;</span><br><span class="line">    &lt;DistFiles Include&#x3D;&quot;$(SpaRoot)dist\**; $(SpaRoot)dist-server\**&quot; &#x2F;&gt;</span><br><span class="line">    &lt;DistFiles Include&#x3D;&quot;$(SpaRoot)node_modules\**&quot; Condition&#x3D;&quot;&#39;$(BuildServerSideRenderer)&#39; &#x3D;&#x3D; &#39;true&#39;&quot; &#x2F;&gt;</span><br><span class="line">    &lt;ResolvedFileToPublish Include&#x3D;&quot;@(DistFiles-&gt;&#39;%(FullPath)&#39;)&quot; Exclude&#x3D;&quot;@(ResolvedFileToPublish)&quot;&gt;</span><br><span class="line">      &lt;RelativePath&gt;%(DistFiles.Identity)&lt;&#x2F;RelativePath&gt;</span><br><span class="line">      &lt;CopyToPublishDirectory&gt;PreserveNewest&lt;&#x2F;CopyToPublishDirectory&gt;</span><br><span class="line">      &lt;ExcludeFromSingleFile&gt;true&lt;&#x2F;ExcludeFromSingleFile&gt;</span><br><span class="line">    &lt;&#x2F;ResolvedFileToPublish&gt;</span><br><span class="line">  &lt;&#x2F;ItemGroup&gt;</span><br><span class="line">&lt;&#x2F;Target&gt;</span><br></pre></td></tr></table></figure>
上例是<span>ASP.NET</span> Core with Angular模板项目使用的build target，两种编译环境，而且其中还有条件语句，有点厉害</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://qqstone.github.io/qqsnote/2020/08/25/ddd/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/qqsnote/images/avatar.gif">
      <meta itemprop="name" content="QQs">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="QQs'Note">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/qqsnote/2020/08/25/ddd/" class="post-title-link" itemprop="url">领域驱动设计</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2020-08-25 16:17:18" itemprop="dateCreated datePublished" datetime="2020-08-25T16:17:18+08:00">2020-08-25</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-09-06 07:56:25" itemprop="dateModified" datetime="2020-09-06T07:56:25+08:00">2020-09-06</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>领域驱动设计(Domain-Driven Design, DDD), 对于复杂的系统的开发, 从需求梳理到编码实现,将涉及的专业知识转换成模型、逻辑是必不可少的环节，这些信息和知识会汇集到若干核心的“领域”，接下来的设计重心会落在核心领域范畴内，确定域界地沟通方式，迭代地在域内完成实现，而不似单纯地服务端的功能堆叠。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://qqstone.github.io/qqsnote/2020/08/18/webassembly/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/qqsnote/images/avatar.gif">
      <meta itemprop="name" content="QQs">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="QQs'Note">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/qqsnote/2020/08/18/webassembly/" class="post-title-link" itemprop="url">webassembly</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2020-08-18 09:29:00" itemprop="dateCreated datePublished" datetime="2020-08-18T09:29:00+08:00">2020-08-18</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2025-07-29 21:06:20" itemprop="dateModified" datetime="2025-07-29T21:06:20+08:00">2025-07-29</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>应该首先从<a target="_blank" rel="noopener" href="http://webassembly.org.cn/getting-started/developers-guide/">官方网站</a>获取知识</p>
<p>webassembly知识储备或许会涵盖“编译原理”，Rust，v8开发，</p>
<blockquote>
<p>WebAssembly或称wasm是一个实验性的低端编程语言，应用于浏览器内的客户端。WebAssembly是便携式的抽象语法树，被设计来提供比JavaScript更快速的编译及运行。WebAssembly将让开发者能运用自己熟悉的编程语言编译，再藉虚拟机引擎在浏览器内运行。 —-维基百科</p>
</blockquote>
<p>背景参考<a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/102692865">《一个白学家眼里的 WebAssembly》</a></p>
<p>曾几何时，有“一切可以由js实现的，终将用js实现”，而webassembly技术为编译型语言（c/c++,jave,c#等）抢夺浏览器战场打开了传送门。<br><br>优势：</p>
<ul>
<li>运行效率高 如应用于文件上传中的扫描<sup><a target="_blank" rel="noopener" href="https://www.zhihu.com/question/265700379/answer/951118579">注1</a></sup></li>
<li>保密性好 见Google reCAPTCHA 另<a target="_blank" rel="noopener" href="https://www.yhspy.com/2019/04/10/%E6%B5%85%E8%B0%88%E5%89%8D%E7%AB%AF%E4%BB%A3%E7%A0%81%E5%8A%A0%E5%AF%86/">航妹博客：浅谈前端代码加密</a></li>
</ul>
<p><strong>为什么wasm效率比js高？因为wasm是二进制指令格式，比执行js代码天然地节省解释和JIT的开销，但效率提高多少要看计算的复杂程度，简单场景或不相上下</strong></p>
<p>课外：为了提高浏览器性能，曾出现过从 NaCl、PNaCl 到 ASM.js，这些技术作为wasm的前辈，有以下特点————(于航《WebAssembly入门》)</p>
<ol>
<li>源码中都使用了类型明确的变量；</li>
<li>应用都拥有独立的运行时环境，并且与原有的 JavaScript 运行时环境分离；</li>
<li>支持将原有的 C/C++ 应用通过某种方式转换到基于这些技术的实现，并可以直接运行在 Web 浏览器中。</li>
</ol>
<p>现状是，四大厂（Mozilla，Google，Microsoft，Apple）共同倾力开发, WebAssembly 技术已成为 W3C 的标准, 其MVP版本(Minimum Viable Product)被主流浏览器支持</p>
<p><a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/WebAssembly">Webassembly MDN</a></p>
<p>工具链<a target="_blank" rel="noopener" href="https://github.com/emscripten-core/emscripten">Emscripten</a>,Rust, AssemblyScript</p>
<blockquote>
<p>In case of conflict, consider users over authors over implementors over specifiers over theoretical purity.</p>
<h4 id="helloworld-wasm"><a href="#helloworld-wasm" class="headerlink" title="helloworld.wasm"></a>helloworld.wasm</h4><p>准备一个新的开发环境：<br>启动一个ubuntu的docker<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">docker pull ubuntu</span><br><span class="line">sudo docker run -it -u root --name labdocker -v labdocker_home:&#x2F;var&#x2F;labdocker_home ubuntu bash</span><br></pre></td></tr></table></figure><br>上面的语句映射的是docker中的/var/labdocker_home和宿主的/var/lib/docker/volumes/labdocker_home/_data wtf???<br>给‘空’的ubuntu安装必要工具<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">apt-get update</span><br><span class="line">apt-get install -y nodejs npm git</span><br></pre></td></tr></table></figure><br>编译工具链依赖<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apt-get install -y cmake python3.8</span><br></pre></td></tr></table></figure><br>安装emsdk<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">git clone https:&#x2F;&#x2F;github.com&#x2F;emscripten-core&#x2F;emsdk.git</span><br><span class="line">cd emsdk</span><br><span class="line">git pull</span><br><span class="line">.&#x2F;emsdk install latest &#x2F;&#x2F; 这一步依赖python</span><br><span class="line">.&#x2F;emsdk activate latest </span><br><span class="line">source .&#x2F;emsdk_env.sh &#x2F;&#x2F; 定义环境变量</span><br></pre></td></tr></table></figure><br>You always have to source ./emsdk_env.sh first in a new terminal session</p>
<p>输入emcc -v查看信息<br><img src="https://i0.wp.com/tvax3.sinaimg.cn/large/a60edd42gy1gidk1ak7cyj20kg05aq50.jpg" alt="emcc"><br>看起来比较正常，说明工具安装成功</p>
</blockquote>
<p><img src="https://i0.wp.com/tvax4.sinaimg.cn/large/a60edd42gy1gidgl4nx6yj20ka0c2n1n.jpg" alt="emsdk setup"></p>
<p>另，其实安装emsdk不是必须的，docker hub中有现成的<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">docker pull emscripten&#x2F;emsdk</span><br><span class="line">docker run --rm -v $(pwd):&#x2F;src -u $(id -u):$(id -g) \</span><br><span class="line">  emscripten&#x2F;emsdk emcc helloworld.cpp -o helloworld.js</span><br></pre></td></tr></table></figure><br>创建一个c项目<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mkdir &#x2F;home&#x2F;Workspace&#x2F;hello</span><br><span class="line">cd &#x2F;home&#x2F;Workspace&#x2F;hello</span><br><span class="line">echo &#39;&#39; &gt; hello.c</span><br></pre></td></tr></table></figure><br>回忆起c的hello world<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">#include&lt;stdio.h&gt;</span><br><span class="line">int main(int argc, char** argv)&#123;</span><br><span class="line">  printf(&quot;hello hello~&#x2F;n&quot;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>走你<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">emcc hello.c -s WASM&#x3D;1 -o hello.html</span><br></pre></td></tr></table></figure></p>
<ul>
<li>参数-s WASM=1 要求生成.wasm否则编译成asm.js</li>
<li>-o hello.html Emscripten 生成一个我们所写程序的HTML页面，并带有 wasm 和 JavaScript 文件<br>编译生成hello.wasm hello.js hello.html 可以用emrun运行这个html(直接用浏览器打开会认为读取file://文件违反policy) 因为docker没有映射端口，拷出来用http-server运行，是这样婶的：<br><img src="https://tva3.sinaimg.cn/large/a60edd42ly1gj59qkbh1mj20qo0i2wf9.jpg" alt="emscript_helloworld"><h4 id="FFmpeg-js-的实现"><a href="#FFmpeg-js-的实现" class="headerlink" title="FFmpeg.js 的实现"></a>FFmpeg.js 的实现</h4>原文：<a target="_blank" rel="noopener" href="https://itnext.io/build-ffmpeg-webassembly-version-ffmpeg-js-part-1-preparation-ed12bf4c8fac">Build FFmpeg WebAssembly version (= ffmpeg.wasm)</a> 此链接国内网络或无法访问，可参考国内博客的类似文章，keyword:”webassemby” + “ffmpeg”</li>
</ul>
<p>关于ffmpeg,<a href="/qqsnote/2019/04/19/video-streaming/" title="video和视频流">video和视频流</a>那篇曾用其进行视频的转码和输出流。<br></p>
<blockquote>
<p>FFmpeg 是一个开放源代码的自由软件，可以运行音频和视频多种格式的录影、转换、流功能，包含了libavcodec(用于多个项目中音频和视频的解码器库)，以及libavformat(音频与视频格式转换库)。————维基百科<br>clone FFmpeg 源码<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git clone https:&#x2F;&#x2F;github.com&#x2F;FFmpeg&#x2F;FFmpeg</span><br></pre></td></tr></table></figure><br>源码根路径INSTALL.md为构建/安装说明<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">.&#x2F;configure</span><br><span class="line">make &amp; make install</span><br></pre></td></tr></table></figure><br>在windows上开发使用cygwin集成linux开发环境（本不应绕此远路），运行cygwin.setup安装程序安装以下库<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">gcc-core</span><br><span class="line">mingw-gcc-core</span><br><span class="line">binutils</span><br><span class="line">gdb</span><br></pre></td></tr></table></figure><br>执行configure加以下参数<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bash .&#x2F;configure --enable-cross-compile --disable-x86asm</span><br></pre></td></tr></table></figure><br>configure大约需要执行十几分钟（或更久，取决于cpu加网速）<br>make issue: ./libavutil/mem.h:342:1: warning: ‘alloc_size’ attribute ignored on a function returning ‘int’ [-Wattributes]<br>  342 | av_alloc_size(2, 3) int av_reallocp_array(void <em>ptr, size_t nmemb, size_t size);<br>      | ^<del>~</del><del>~</del>~~<br>make: **</em> [ffbuild/common.mak:60: libavformat/mov_esds.o] Interrupt</p>
</blockquote>
<p>旧版本函数参数不一致导致的问题，已被修复，见<a target="_blank" rel="noopener" href="https://patchwork.ffmpeg.org/project/ffmpeg/patch/20181124210202.52207-1-mark.hsj@gmail.com/">[FFmpeg-devel] avutil/mem: Fix invalid use of av_alloc_size</a><br></p>
<p>——————two weeks later————————<br><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">git clone https:&#x2F;&#x2F;github.com&#x2F;FFmpeg&#x2F;FFmpeg</span><br><span class="line">cd FFmpeg</span><br><span class="line">.configure - --disable-x86asm &#x2F;&#x2F; 这一步是根据configure生成MakeFile</span><br><span class="line">make &#x2F;&#x2F; 编译</span><br><span class="line">make install &#x2F;&#x2F; 将编译产出复制到(安装)到linux的相应位置</span><br></pre></td></tr></table></figure><br>测试FFmpeg可以尝试在终端使用媒体编辑功能<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ffmpeg --help</span><br><span class="line">ffmpeg -i test.mov -strict -2 -vf crop&#x3D;720:405:0:451 out.mp4</span><br><span class="line">&#x2F;&#x2F; 从test.mov中裁剪720*405大小区域，裁剪偏移（0，451）输出为out.mp4 </span><br></pre></td></tr></table></figure><br>我们目的是要生成.wasm放到浏览器中,这里用到Emscripten<br></p>
<blockquote>
<p>Emscripten compiles C and C++ to WebAssembly using LLVM and Binaryen. Emscripten output can run on the Web, in Node.js, and in wasm runtimes. ——— <a target="_blank" rel="noopener" href="https://github.com/emscripten-core/emscripten#readme">《Emscripten ReadMe》</a></p>
</blockquote>
<p>回到make这步的输出项中：<br><img src="https://tva1.sinaimg.cn/large/a60edd42gy1gidep9pbn7j20kg07y410.jpg" alt="ffmegoutput"><br>这个泛着绿光的ffmpeg就是Binaryen（二进制文件）<br><a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/LLVM">LLVM</a>(low level virtual machine)不限于字面意思的编译环境<br>关于emcc<br><br><img src="https://emcc.zcopy.site/_images/EmscriptenToolchain.png" alt=""></p>
<ul>
<li>Emcc 使用 Clang 和 LLVM 编译生成 Wasm或者asm.js</li>
<li>Emscripten SDK (emsdk) 配置 .emscriten, 用于管理多份SDK和工具，指定当前正在使用的编译代码(Active Tool/SDK)。</li>
</ul>
<p>工具链依赖<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apt-get install -y cmake python3.8</span><br></pre></td></tr></table></figure><br>安装emsdk<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">git clone https:&#x2F;&#x2F;github.com&#x2F;emscripten-core&#x2F;emsdk.git</span><br><span class="line">cd emsdk</span><br><span class="line">git pull</span><br><span class="line">.&#x2F;emsdk install latest &#x2F;&#x2F; 这一步依赖python</span><br><span class="line">.&#x2F;emsdk activate latest </span><br><span class="line">source .&#x2F;emsdk_env.sh &#x2F;&#x2F; 定义环境变量</span><br></pre></td></tr></table></figure></p>
<blockquote>
<p>You always have to source ./emsdk_env.sh first in a new terminal session</p>
<p>输入emcc -v查看信息<br><img src="https://i0.wp.com/tvax3.sinaimg.cn/large/a60edd42gy1gidk1ak7cyj20kg05aq50.jpg" alt="emcc"><br>看起来比较正常，说明工具安装成功</p>
</blockquote>
<p><img src="https://i0.wp.com/tvax4.sinaimg.cn/large/a60edd42gy1gidgl4nx6yj20ka0c2n1n.jpg" alt="emsdk setup"></p>
<p>另，其实安装emsdk不是必须的，docker hub中有现成的<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">docker pull emscripten&#x2F;emsdk</span><br><span class="line">docker run --rm -v $(pwd):&#x2F;src -u $(id -u):$(id -g) \</span><br><span class="line">  emscripten&#x2F;emsdk emcc helloworld.cpp -o helloworld.js</span><br></pre></td></tr></table></figure><br>将FFmpeg源码编译成LLVM二进制码, 相比之前的configure &amp;&amp; make这里不仅要使用emconfigure 命令，而且要设置下述的若干参数，于是做一个build .sh:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">#!&#x2F;bin&#x2F;bash -x</span><br><span class="line"></span><br><span class="line"># verify Emscripten version</span><br><span class="line">emcc -v</span><br><span class="line"></span><br><span class="line"># configure FFMpeg with Emscripten</span><br><span class="line">CFLAGS&#x3D;&quot;-s USE_PTHREADS&quot;</span><br><span class="line">LDFLAGS&#x3D;&quot;$CFLAGS -s INITIAL_MEMORY&#x3D;33554432&quot; # 33554432 bytes &#x3D; 32 MB</span><br><span class="line">CONFIG_ARGS&#x3D;(</span><br><span class="line">  --target-os&#x3D;none        # use none to prevent any os specific configurations</span><br><span class="line">  --arch&#x3D;x86_32           # use x86_32 to achieve minimal architectural optimization</span><br><span class="line">  --enable-cross-compile  # enable cross compile</span><br><span class="line">  --disable-x86asm        # disable x86 asm</span><br><span class="line">  --disable-inline-asm    # disable inline asm</span><br><span class="line">  --disable-stripping     # disable stripping</span><br><span class="line">  --disable-programs      # disable programs build (incl. ffplay, ffprobe &amp; ffmpeg)</span><br><span class="line">  --disable-doc           # disable doc</span><br><span class="line">  --extra-cflags&#x3D;&quot;$CFLAGS&quot;</span><br><span class="line">  --extra-cxxflags&#x3D;&quot;$CFLAGS&quot;</span><br><span class="line">  --extra-ldflags&#x3D;&quot;$LDFLAGS&quot;</span><br><span class="line">  --nm&#x3D;&quot;llvm-nm -g&quot;</span><br><span class="line">  --ar&#x3D;emar</span><br><span class="line">  --as&#x3D;llvm-as</span><br><span class="line">  --ranlib&#x3D;llvm-ranlib</span><br><span class="line">  --cc&#x3D;emcc</span><br><span class="line">  --cxx&#x3D;em++</span><br><span class="line">  --objcc&#x3D;emcc</span><br><span class="line">  --dep-cc&#x3D;emcc</span><br><span class="line">)</span><br><span class="line">emconfigure .&#x2F;configure &quot;$&#123;CONFIG_ARGS[@]&#125;&quot;</span><br><span class="line"></span><br><span class="line"># build dependencies</span><br><span class="line">emmake make -j4</span><br><span class="line"></span><br><span class="line"># build ffmpeg.wasm</span><br><span class="line">mkdir -p wasm&#x2F;dist</span><br><span class="line">ARGS&#x3D;(</span><br><span class="line">  -I. -I.&#x2F;fftools</span><br><span class="line">  -Llibavcodec -Llibavdevice -Llibavfilter -Llibavformat -Llibavresample -Llibavutil -Llibpostproc -Llibswscale -Llibswresample</span><br><span class="line">  -Qunused-arguments</span><br><span class="line">  -o wasm&#x2F;dist&#x2F;ffmpeg.js fftools&#x2F;ffmpeg_opt.c fftools&#x2F;ffmpeg_filter.c fftools&#x2F;ffmpeg_hw.c fftools&#x2F;cmdutils.c fftools&#x2F;ffmpeg.c</span><br><span class="line">  -lavdevice -lavfilter -lavformat -lavcodec -lswresample -lswscale -lavutil -lm</span><br><span class="line">  -s USE_SDL&#x3D;2                    # use SDL2</span><br><span class="line">  -s USE_PTHREADS&#x3D;1               # enable pthreads support</span><br><span class="line">  -s INITIAL_MEMORY&#x3D;33554432      # 33554432 bytes &#x3D; 32 MB</span><br><span class="line">)</span><br><span class="line">emcc &quot;$&#123;ARGS[@]&#125;&quot;</span><br></pre></td></tr></table></figure></p>
<h4 id="EMCC-DEBUG"><a href="#EMCC-DEBUG" class="headerlink" title="EMCC_DEBUG"></a>EMCC_DEBUG</h4><p>设置EMCC_DEBUG变量使用调试模式编译wasm<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">EMCC_DEBUG&#x3D;1 emcc dip.cc </span><br><span class="line">  -s WASM&#x3D;1 </span><br><span class="line">  -O3 </span><br><span class="line">  --no-entry </span><br><span class="line">  -o dip.wasm</span><br></pre></td></tr></table></figure></p>
<h4 id="issues-expected-magic-word-00-61-73-6d-found-…"><a href="#issues-expected-magic-word-00-61-73-6d-found-…" class="headerlink" title="issues expected magic word 00 61 73 6d, found …"></a>issues expected magic word 00 61 73 6d, found …</h4><p>获取的wasm模块的MIME type不是application/wasm</p>
<h4 id="关于wasm的调用"><a href="#关于wasm的调用" class="headerlink" title="关于wasm的调用"></a>关于wasm的调用</h4><p>WebAssembly还没有和 \<script type='module'> 或ES6的import语句集成，也就是说，当前还没有内置的方式让浏览器直接获取模块。<br>ensdk生成的wasm js为js逻辑和wasm模块充当‘接口’<br>实际上，在wasm js中，用fetch获取wasm文件的二进制代码，存入ArrayBuffer对象，并使用现代WebApi提供的<a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/WebAssembly">WebAssembly</a>对象，调用WebAssembly.instantiate()将带类型数组(ArrayBuffer)编译和实例化为wasm module的对象<br>大致形如<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">fetch(&#39;module.wasm&#39;).then(response &#x3D;&gt;</span><br><span class="line">  response.arrayBuffer()</span><br><span class="line">).then(bytes &#x3D;&gt;</span><br><span class="line">  WebAssembly.instantiate(bytes, importObject)</span><br><span class="line">).then(results &#x3D;&gt; &#123;</span><br><span class="line">  &#x2F;&#x2F; Do something with the compiled results!</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://qqstone.github.io/qqsnote/2020/08/04/vtk/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/qqsnote/images/avatar.gif">
      <meta itemprop="name" content="QQs">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="QQs'Note">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/qqsnote/2020/08/04/vtk/" class="post-title-link" itemprop="url">vtk</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2020-08-04 10:03:13" itemprop="dateCreated datePublished" datetime="2020-08-04T10:03:13+08:00">2020-08-04</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2025-03-02 20:11:18" itemprop="dateModified" datetime="2025-03-02T20:11:18+08:00">2025-03-02</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/qqsnote/categories/%E5%9B%BE%E5%83%8F%E5%A4%84%E7%90%86/" itemprop="url" rel="index"><span itemprop="name">图像处理</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>The Rendering Engine<br>mapper</p>
<h4 id="vtk-js-—-gt-kitware-vtk-js"><a href="#vtk-js-—-gt-kitware-vtk-js" class="headerlink" title="vtk.js —&gt; @kitware/vtk.js"></a>vtk.js —&gt; @kitware/vtk.js</h4><p>歪果仁不像码农期待的那样勤奋，官方的模板（如react-vtk-js）以及范例框架（ParaviewWeb）还是使用的vtk.js旧版本<br>对于旧版本，提供了<a target="_blank" rel="noopener" href="https://www.npmjs.com/package/craco-vtk">craco-vtk</a>包进行移植<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install --save @craco&#x2F;craco craco-vtk vtk.js shader-loader worker-loader css-loader style-loader postcss-loader</span><br></pre></td></tr></table></figure><br>craco-vtk在GitHub上的Repo已被移除(不过可以找到fork)，内容可参考<a target="_blank" rel="noopener" href="https://github.com/InsightSoftwareConsortium/craco-itk">craco-itk</a></p>
<p>itk(Insight Segmentation and Registration Toolkit) 基于vtk的医学图像配准和分割工具包</p>
<h4 id="pipeline"><a href="#pipeline" class="headerlink" title="pipeline"></a>pipeline</h4><p><img src="https://tva3.sinaimg.cn/large/a60edd42gy1gvuuf066c7j20ko0aljuv.jpg" alt="vtk pipeline"></p>
<ul>
<li>reader</li>
<li>filter<h4 id="vtkActor"><a href="#vtkActor" class="headerlink" title="vtkActor"></a>vtkActor</h4>派生自vtkProp类，渲染场景中数据的可视化表达是通过<b>vtkProp</b>的子类负责的。<del>比如，本例要渲染一个柱体，柱体的数据类型是vtkPolyData，</del>数据要在场景中渲染时，不是直接把数据加入渲染场景就可以，待渲染的数据是以vtkProp对象存在于渲染场景中。</li>
</ul>
<p>而<b>vtkActor</b>(表达场景中的几何数据)和<b>vtkVolume</b>(表达场景中的体数据)是三维空间中渲染对象最常用的vtkProp子类；二维空间中的数据则是用vtkActor2D表达。</p>
<p>vtkProp子类负责确定渲染场景中对象的位置、大小和方向信息。Prop依赖于两个对象(Prop一词来源于戏剧里的“道具”，在VTK里表示的是渲染场景中可以看得到的对象。)，一个是Mapper(vtkMapper)对象，负责存放数据和渲染信息，另一个是属性(<b>vtkProperty</b>)对象，负责控制颜色、不透明度等参数。</p>
<p>VTK中定义了大量(超过50个)的Prop类，如vtkImageActor(负责图像显示)和vtkPieChartActor(用于创建数组数据的饼图可视化表达)。其中的一些Prop内部直接包括了控制显示的参数和待渲染数据的索引，因此并不需要额外的Property和Mapper对象。vtkActor的子类vtkFollower可以自动的更新方向信息以保持始终面向一个特定的相机。这样无论怎样旋转，三维场景中的广告板(Billboards)或者文本都是可见的。vtkActor的子类vtkLODActor可以自动改变自身的几何表达来实现需要达到的交互帧率。vtkProp3D的子类vtkLODProp3D则是通过从许多Mapper(可以是体数据的Mapper和几何数据的Mapper集合)中进行选择来实现交互。vtkAssembly建立Actor的等级结构以便在整个结构平移、旋转或者缩放时能够更合理的控制变换。</p>
<p>vtkActor::SetMapper()——设置生成几何图元的Mapper。即连接一个Actor到可视化pipeline的末端(可视化pipeline的末端就是Mapper)。</p>
<h4 id="vtkMapper"><a href="#vtkMapper" class="headerlink" title="vtkMapper"></a>vtkMapper</h4><p>将输入的数据转换为几何图元(graphics primitives：点、线、多边形)进行渲染。</p>
<h4 id="vtkRenderer"><a href="#vtkRenderer" class="headerlink" title="vtkRenderer"></a>vtkRenderer</h4><p>负责管理场景scenes和角色actors的渲染过程。组成场景的所有对象包括Prop，照相机(Camera)和光照(Light)都被集中在一个vtkRenderer对象中。父类vtkViewport。一个vtkRenderWindow中可以有多个vtkRenderer对象，而这些vtkRenderer可以渲染在窗口中不同的矩形区域中(即视口)，或者覆盖整个窗口区域。<br><img src="https://tva3.sinaimg.cn/large/a60edd42gy1gvuuqicoz4j20mj09s427.jpg" alt="vtk renderer"></p>
<ul>
<li>vtkRenderer::AddActor()</li>
<li>vtkRenderer::SetBackground()</li>
<li>vtkRenderer::updateLightsGeometryToFollowCamera() light跟随camera<br>camera<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cam &#x3D; renderer.getActiveCamera();</span><br><span class="line">cam.setParallelProjection(true); &#x2F;&#x2F;透视，false为平行 Parallel Projection</span><br></pre></td></tr></table></figure>
获取平行放大比率 getParallelScale<br><strong>MouseWheel的滚动事件并非移动camera的距离，而是将视野中心的区域放大，相当于视场角缩小，投影比例增大</strong><h4 id="vtkRenderWindow"><a href="#vtkRenderWindow" class="headerlink" title="vtkRenderWindow"></a>vtkRenderWindow</h4>连接操作系统与VTK渲染引擎</li>
</ul>
<h4 id="Interactor"><a href="#Interactor" class="headerlink" title="Interactor"></a>Interactor</h4><p>提供平台独立的响应鼠标、键盘和时钟事件的交互机制，通过VTK的Command/Observer设计模式将监听到的特定平台的鼠标、键盘和时钟事件交由vtkInteractorObserver或其子类，如vtkInteractorStyle进行处理。vtkInteractorStyle等监听这些消息并进行处理以完成旋转、拉伸和放缩等运动控制。vtkRenderWindowInteractor自动建立一个默认的3D场景交互器样式(Interactor Style)：vtkInteractorStyleSwitch，当然你也可以选择其他的交互器样式，或者是创建自己的交互器样式。在本例中，我们就是选择了其他的交互器样式来替代默认的：vtkInteractorStyleTrackballCamera</p>
<ul>
<li><p>vtkRenderWindowInteractor::SetRenderWindow()——设置渲染窗口，消息是通过渲染窗口捕获到的，所以必须要给交互器对象设置渲染窗口。</p>
</li>
<li><p>vtkRenderWindowInteractor::SetInteractorStyle()——定义交互器样式，默认的交互样式为vtkInteractorStyleSwitch。</p>
</li>
<li><p>vtkRenderWindowInteractor::Initialize() ——为处理窗口事件做准备，交互器工作之前必须先调用这个方法进行初始化。</p>
</li>
<li><p>vtkRenderWindowInteractor::Start() ——开始进入事件响应循环，交互器处于等待状态，等待用户交互事件的发生。进入事件响应循环之前必须先调用Initialize()方法。</p>
</li>
</ul>
<a href="/qqsnote/2021/10/25/vtk-interactor/" title="interactor">interactor</a>
<h4 id="vtkInteractorStyleTrackballCamera"><a href="#vtkInteractorStyleTrackballCamera" class="headerlink" title="vtkInteractorStyleTrackballCamera"></a>vtkInteractorStyleTrackballCamera</h4><p>交互器样式的一种，该样式下，用户是通过控制相机对物体作旋转、放大、缩小等操作。</p>
<p><img src="https://i0.wp.com/tvax2.sinaimg.cn/large/a60edd42gy1ghelso7vv1j20gz08paaw.jpg" alt="vtk scope"></p>
<h4 id="官方-paraview"><a href="#官方-paraview" class="headerlink" title="官方 paraview"></a>官方 paraview</h4><p><a target="_blank" rel="noopener" href="https://www.cb.uu.se/~aht/VizPhD2018/Paraview.pdf">paraview</a></p>
<h4 id="example"><a href="#example" class="headerlink" title="example"></a>example</h4><ol>
<li>source<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cube &#x3D; vtk.vtkCubeSource(0)</span><br></pre></td></tr></table></figure></li>
<li>mapper<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">cuber_mapper &#x3D; vtk.vtkPolyDataMapper()</span><br><span class="line">cuber_mapper.SetInputConnection(</span><br><span class="line">    cube.GetOutPort()</span><br><span class="line">)</span><br></pre></td></tr></table></figure></li>
<li>actor<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cube_actor &#x3D; vtk.vtkActor()</span><br><span class="line">cube_actor.SetMapper(cube_mapper)</span><br><span class="line">cube_actor.GetProperty.SetColor(1.0, 1.0, 1.0)</span><br></pre></td></tr></table></figure></li>
<li>renderer<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">renderer &#x3D; vtk.vtkRenderer()</span><br><span class="line">renderer.SetBackground(0.0, 0.0, 0.0)</span><br><span class="line">renderer.AddActor(cube_actor)</span><br></pre></td></tr></table></figure></li>
<li>renderwindow<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">render_window &#x3D; vtk.vtkRenderWindow()</span><br><span class="line">render_window.SetWindowName(&quot;Simple VTK scene&quot;)</span><br><span class="line">render_window.SetSize(400, 400)</span><br><span class="line">render_window.AddRenderer(renderer)</span><br></pre></td></tr></table></figure></li>
<li>interactor<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"># Create an interactor</span><br><span class="line">interactor &#x3D; vtk.vtkRenderWindowInteractor()</span><br><span class="line">interactor.SetRenderWindow(render_window)</span><br><span class="line"># Initialize the interactor and start the</span><br><span class="line"># rendering loop</span><br><span class="line">interactor.Initialize()</span><br><span class="line">render_window.Render()</span><br></pre></td></tr></table></figure></li>
</ol>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://qqstone.github.io/qqsnote/2020/07/30/Redux/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/qqsnote/images/avatar.gif">
      <meta itemprop="name" content="QQs">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="QQs'Note">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/qqsnote/2020/07/30/Redux/" class="post-title-link" itemprop="url">Redux</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2020-07-30 10:52:25" itemprop="dateCreated datePublished" datetime="2020-07-30T10:52:25+08:00">2020-07-30</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-04-16 20:11:32" itemprop="dateModified" datetime="2022-04-16T20:11:32+08:00">2022-04-16</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>这里是React-Redux，Redux状态管理的React绑定库，使React组件从Redux store中读取数据，并且向store分发actions以更新数据<br><img src="https://gowa.club/res/1*QERgzuzphdQz4e0fNs1CFQ.gif" alt=""><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">npm install --save react-redux</span><br><span class="line">或</span><br><span class="line">yarn add react-redux</span><br></pre></td></tr></table></figure><br>另，有typescript的definition包：@types/react-redux</p>
<p>以Provider组件载入Redux store<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">import React from &quot;react&quot;;</span><br><span class="line">import ReactDOM from &quot;react-dom&quot;;</span><br><span class="line"></span><br><span class="line">import &#123; Provider &#125; from &quot;react-redux&quot;;</span><br><span class="line">import store from &quot;.&#x2F;store&quot;;</span><br><span class="line"></span><br><span class="line">import App from &quot;.&#x2F;App&quot;;</span><br><span class="line"></span><br><span class="line">const rootElement &#x3D; document.getElementById(&quot;root&quot;);</span><br><span class="line">ReactDOM.render(</span><br><span class="line">  &lt;Provider store&#x3D;&#123;store&#125;&gt;</span><br><span class="line">    &lt;App &#x2F;&gt;</span><br><span class="line">  &lt;&#x2F;Provider&gt;,</span><br><span class="line">  rootElement</span><br><span class="line">);</span><br></pre></td></tr></table></figure><br>使用Hooks调用Redux store<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">import React from &#39;react&#39;</span><br><span class="line">import &#123; useSelector, useDispatch &#125; from &#39;react-redux&#39;</span><br><span class="line">import &#123;</span><br><span class="line">  decrement,</span><br><span class="line">  increment,</span><br><span class="line">  incrementByAmount,</span><br><span class="line">  incrementAsync,</span><br><span class="line">  selectCount,</span><br><span class="line">&#125; from &#39;.&#x2F;counterSlice&#39;</span><br><span class="line">import styles from &#39;.&#x2F;Counter.module.css&#39;</span><br><span class="line"></span><br><span class="line">export function Counter() &#123;</span><br><span class="line">  const count &#x3D; useSelector(selectCount)</span><br><span class="line">  const dispatch &#x3D; useDispatch()</span><br><span class="line"></span><br><span class="line">  return (</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">      &lt;div className&#x3D;&#123;styles.row&#125;&gt;</span><br><span class="line">        &lt;button</span><br><span class="line">          className&#x3D;&#123;styles.button&#125;</span><br><span class="line">          aria-label&#x3D;&quot;Increment value&quot;</span><br><span class="line">          onClick&#x3D;&#123;() &#x3D;&gt; dispatch(increment())&#125;</span><br><span class="line">        &gt;</span><br><span class="line">          +</span><br><span class="line">        &lt;&#x2F;button&gt;</span><br><span class="line">        &lt;span className&#x3D;&#123;styles.value&#125;&gt;&#123;count&#125;&lt;&#x2F;span&gt;</span><br><span class="line">        &lt;button</span><br><span class="line">          className&#x3D;&#123;styles.button&#125;</span><br><span class="line">          aria-label&#x3D;&quot;Decrement value&quot;</span><br><span class="line">          onClick&#x3D;&#123;() &#x3D;&gt; dispatch(decrement())&#125;</span><br><span class="line">        &gt;</span><br><span class="line">          -</span><br><span class="line">        &lt;&#x2F;button&gt;</span><br><span class="line">      &lt;&#x2F;div&gt;</span><br><span class="line">      &#123;&#x2F;* omit additional rendering output here *&#x2F;&#125;</span><br><span class="line">    &lt;&#x2F;div&gt;</span><br><span class="line">  )</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h4 id="store"><a href="#store" class="headerlink" title="store"></a>store</h4><p>一个待办列表（todo list）的store示例<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  todos: [&#123;</span><br><span class="line">    text: &#39;Eat food&#39;,</span><br><span class="line">    completed: true</span><br><span class="line">  &#125;, &#123;</span><br><span class="line">    text: &#39;Exercise&#39;,</span><br><span class="line">    completed: false</span><br><span class="line">  &#125;],</span><br><span class="line">  visibilityFilter: &#39;SHOW_COMPLETED&#39;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>store管理状态，状态不可随意改变</p>
<h4 id="action"><a href="#action" class="headerlink" title="action"></a>action</h4><p>action用以触发状态更新 形如<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;type:&#39;action_nameXX&#39;, value:&#39;any value&#39;&#125;</span><br></pre></td></tr></table></figure></p>
<h4 id="reduce"><a href="#reduce" class="headerlink" title="reduce"></a>reduce</h4><p>联系state和action的方法 即传入state action 根据action更新state 最后返回新的state<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">function visibilityFilter(state &#x3D; &#39;SHOW_ALL&#39;, action) &#123;</span><br><span class="line">  switch (action.type) &#123;</span><br><span class="line">    case &#39;SET_VISIBILITY_FILTER&#39;:</span><br><span class="line">      return action.filter</span><br><span class="line">    default:</span><br><span class="line">      return state</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function todos(state &#x3D; [], action) &#123;</span><br><span class="line">  switch (action.type) &#123;</span><br><span class="line">    case &#39;ADD_TODO&#39;:</span><br><span class="line">      return [</span><br><span class="line">        ...state,</span><br><span class="line">        &#123;</span><br><span class="line">          text: action.text,</span><br><span class="line">          completed: false</span><br><span class="line">        &#125;</span><br><span class="line">      ]</span><br><span class="line">    case &#39;COMPLETE_TODO&#39;:</span><br><span class="line">      return state.map((todo, index) &#x3D;&gt; &#123;</span><br><span class="line">        if (index &#x3D;&#x3D;&#x3D; action.index) &#123;</span><br><span class="line">          return Object.assign(&#123;&#125;, todo, &#123;</span><br><span class="line">            completed: true</span><br><span class="line">          &#125;)</span><br><span class="line">        &#125;</span><br><span class="line">        return todo</span><br><span class="line">      &#125;)</span><br><span class="line">    default:</span><br><span class="line">      return state</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h4 id="Flux-Immutable"><a href="#Flux-Immutable" class="headerlink" title="Flux Immutable"></a>Flux Immutable</h4><h4 id="数据流"><a href="#数据流" class="headerlink" title="数据流"></a>数据流</h4><p>createStore<br>useSelector<br>dispatch<br>middleware</p>
<h4 id="语法糖"><a href="#语法糖" class="headerlink" title="语法糖"></a>语法糖</h4><p>createSlice</p>
<h4 id="关于state-tree极其reducer的嵌套"><a href="#关于state-tree极其reducer的嵌套" class="headerlink" title="关于state tree极其reducer的嵌套"></a>关于state tree极其reducer的嵌套</h4><p>从vuex迁移 原vuex代码<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line">export const initialState &#x3D; () &#x3D;&gt; (&#123;</span><br><span class="line">  data: &#123;</span><br><span class="line">    nextID: 1,</span><br><span class="line">    index: &#123;&#125;,</span><br><span class="line">    imageIDs: [],</span><br><span class="line">    dicomIDs: [],</span><br><span class="line">    modelIDs: [],</span><br><span class="line">    labelmapIDs: [],</span><br><span class="line">    vtkCache: &#123;&#125;,</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  &#x2F;&#x2F; track the mapping from volumeID to data ID</span><br><span class="line">  dicomVolumeToDataID: &#123;&#125;,</span><br><span class="line">  selectedBaseImage: NO_SELECTION,</span><br><span class="line"></span><br><span class="line">  &#x2F;&#x2F; data-data associations, in parent-of or child-of relationships.</span><br><span class="line">  &#x2F;&#x2F; is used for cascaded deletes</span><br><span class="line">  dataAssoc: &#123;</span><br><span class="line">    childrenOf: &#123;&#125;,</span><br><span class="line">    parentOf: &#123;&#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">export default (deps) &#x3D;&gt;</span><br><span class="line">  new Vuex.Store(&#123;</span><br><span class="line">    modules: &#123;</span><br><span class="line">      dicom: dicom(deps),</span><br><span class="line">      visualization: visualization(deps),</span><br><span class="line">      widgets: widgets(deps),</span><br><span class="line">      annotations: annotations(deps),</span><br><span class="line">      measurements: measurements(deps),</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    state: initialState(),</span><br><span class="line"></span><br><span class="line">    getters: &#123;</span><br><span class="line">      visibleLabelmaps(state) &#123;</span><br><span class="line">        return state.data.labelmapIDs.filter(</span><br><span class="line">          (id) &#x3D;&gt; state.dataAssoc.parentOf[id] &#x3D;&#x3D;&#x3D; state.selectedBaseImage</span><br><span class="line">        );</span><br><span class="line">      &#125;,</span><br><span class="line">      sceneObjectIDs(state, getters) &#123;</span><br><span class="line">        const &#123; selectedBaseImage, data &#125; &#x3D; state;</span><br><span class="line">        const order &#x3D; [].concat(getters.visibleLabelmaps, data.modelIDs);</span><br><span class="line">        if (selectedBaseImage !&#x3D;&#x3D; NO_SELECTION) &#123;</span><br><span class="line">          order.unshift(selectedBaseImage);</span><br><span class="line">        &#125;</span><br><span class="line">        return order;</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    mutations: &#123;</span><br><span class="line">      ...datasets.mutations,</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    actions: &#123;</span><br><span class="line">      ...datasets.makeActions(deps),</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;);</span><br></pre></td></tr></table></figure><br>redux:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">const preloadedState &#x3D; &#123;</span><br><span class="line">  data: &#123;</span><br><span class="line">    nextID: 1,</span><br><span class="line">    index: &#123;&#125;,</span><br><span class="line">    imageIDs: [],</span><br><span class="line">    dicomIDs: [],</span><br><span class="line">    modelIDs: [],</span><br><span class="line">    labelmapIDs: [],</span><br><span class="line">    vtkCache: &#123;&#125;,</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  &#x2F;&#x2F; track the mapping from volumeID to data ID</span><br><span class="line">  dicomVolumeToDataID: &#123;&#125;,</span><br><span class="line">  selectedBaseImage: -1,</span><br><span class="line"></span><br><span class="line">  &#x2F;&#x2F; data-data associations, in parent-of or child-of relationships.</span><br><span class="line">  &#x2F;&#x2F; is used for cascaded deletes</span><br><span class="line">  dataAssoc: &#123;</span><br><span class="line">    childrenOf: &#123;&#125;,</span><br><span class="line">    parentOf: &#123;&#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">  widgets: &#123; focusedWidget: -1, widgetList: [], activeWidgetID: -1 &#125;,</span><br><span class="line">  annotations: &#123;</span><br><span class="line">    selectedLabelmap: -1,</span><br><span class="line">    currentLabelFor: &#123;&#125;, &#x2F;&#x2F; labelmap ID -&gt; currently selected label</span><br><span class="line">    labels: &#123;&#125;, &#x2F;&#x2F; labelmapID -&gt; label -&gt; color</span><br><span class="line">    radius: 0,</span><br><span class="line">    radiusRange: [1, 100],</span><br><span class="line">  &#125;,</span><br><span class="line">  measurements: &#123;</span><br><span class="line">    widgets: [], &#x2F;&#x2F; list of widget ids</span><br><span class="line">    measurements: &#123;&#125;, &#x2F;&#x2F; widget ID -&gt; opaque measurement obj</span><br><span class="line">    &#x2F;&#x2F; widget&#x2F;measurement parent is the base image association</span><br><span class="line">    parents: &#123;&#125;, &#x2F;&#x2F; data ID -&gt; [widget ID]</span><br><span class="line">    widgetParent: &#123;&#125;, &#x2F;&#x2F; widget ID -&gt; data ID</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line">const store &#x3D; createStore(reducer, preloadedState);</span><br><span class="line"></span><br><span class="line">const reducer &#x3D; (state, action) &#x3D;&gt; &#123;</span><br><span class="line">  return &#123;</span><br><span class="line">    ...state,</span><br><span class="line">    widgets: widgets(state.widgets, action),</span><br><span class="line">    annotations: annotations(state.annotations, action),</span><br><span class="line">    measurements: widgets(state.measurements, action),</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://qqstone.github.io/qqsnote/2020/07/27/CSharp-KernalMethod/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/qqsnote/images/avatar.gif">
      <meta itemprop="name" content="QQs">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="QQs'Note">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/qqsnote/2020/07/27/CSharp-KernalMethod/" class="post-title-link" itemprop="url">C# kernal常用方法</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2020-07-27 10:45:30" itemprop="dateCreated datePublished" datetime="2020-07-27T10:45:30+08:00">2020-07-27</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2025-07-31 21:30:51" itemprop="dateModified" datetime="2025-07-31T21:30:51+08:00">2025-07-31</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/qqsnote/categories/%E5%90%8E%E7%AB%AF%E6%8A%80%E6%9C%AF/" itemprop="url" rel="index"><span itemprop="name">后端技术</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[DllImport(&quot;kernel32.dll&quot;, CharSet &#x3D; CharSet.Auto, SetLastError &#x3D; true)]</span><br><span class="line">static extern bool SetDllDirectory(string lpPathName);</span><br><span class="line"></span><br><span class="line">protected override void OnStartup(StartupEventArgs e)</span><br><span class="line">&#123;</span><br><span class="line">    SetDllDirectory(AppContext.BaseDirectory + &quot;VisualEngine&quot;);</span><br><span class="line">    base.OnStartup(e);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://qqstone.github.io/qqsnote/2020/07/27/CSharp/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/qqsnote/images/avatar.gif">
      <meta itemprop="name" content="QQs">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="QQs'Note">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/qqsnote/2020/07/27/CSharp/" class="post-title-link" itemprop="url">C#</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2020-07-27 10:45:30" itemprop="dateCreated datePublished" datetime="2020-07-27T10:45:30+08:00">2020-07-27</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2025-06-08 20:33:40" itemprop="dateModified" datetime="2025-06-08T20:33:40+08:00">2025-06-08</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/qqsnote/categories/%E5%90%8E%E7%AB%AF%E6%8A%80%E6%9C%AF/" itemprop="url" rel="index"><span itemprop="name">后端技术</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h4 id="编程概念"><a href="#编程概念" class="headerlink" title="编程概念"></a>编程概念</h4><p><a target="_blank" rel="noopener" href="https://docs.microsoft.com/zh-cn/dotnet/csharp/programming-guide/concepts/">Microsoft Docs: C#</a></p>
<ul>
<li>.NET 中的程序集 程序集是.net应用程序的最小部署单元。它可以是dll或exe。</li>
<li>使用 Async 和 Await 的异步编程 (使用Task保存异步操作)</li>
<li>特性 (Attribute)    将元数据或声明性信息与代码相关联。 关联的特性在运行时使用 反射 这项技术实现</li>
<li>集合 (C#)    介绍了 .NET 提供的一些类型集合。 展示了如何使用简单的集合和键/值对集合。</li>
<li>协变和逆变 (C#)    介绍了如何在接口和委托中启用隐式转换泛型类型参数。</li>
<li>表达式树 (C#)    介绍了如何使用表达式树来启用动态修改可执行代码。</li>
<li>迭代器 (C#)    介绍了用于单步执行集合并一次返回一个元素的迭代器。</li>
<li>语言集成查询 (LINQ) (C#)    介绍了 C# 语言语法中强大的查询功能，以及用于查询关系数据库、XML 文档、数据集和内存中集合的模型。</li>
<li>反射 (C#)    介绍了如何使用反射来动态创建类型实例、将类型绑定到现有对象，或从现有对象获取类型并调用其方法或访问其字段和属性。</li>
<li>序列化 (C#)    还介绍了有关二进制、XML 和 SOAP 序列化的关键概念。<h4 id="object-值类型和引用类型-装箱拆箱"><a href="#object-值类型和引用类型-装箱拆箱" class="headerlink" title="object 值类型和引用类型 装箱拆箱"></a>object 值类型和引用类型 装箱拆箱</h4>值类型：</li>
<li>简单类型</li>
<li>结构体</li>
<li>枚举</li>
<li>存于栈中 自动释放</li>
<li>不可派生<br>引用类型</li>
<li>类定义</li>
<li>接口</li>
<li>String</li>
<li>Array</li>
<li>存于堆 手动释放<br>值类型转换为引用类型为装箱 反之为拆箱，装箱拆箱操作显著消耗系统资源 应当避免<h4 id="decimal"><a href="#decimal" class="headerlink" title="decimal"></a>decimal</h4>因为float计算时有精度损耗，而且产生损耗时在程序中并不提示，于是创建decimal类型，付出额外的性能，进行高精度计算<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">decimal d&#x3D;1.23M</span><br></pre></td></tr></table></figure>
<h4 id="foreach"><a href="#foreach" class="headerlink" title="foreach"></a>foreach</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">foreach (Object item in items)&#123;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="string-format"><a href="#string-format" class="headerlink" title="string format"></a>string format</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">String result &#x3D; $&quot;the value is &#123;value&#125;&quot;</span><br></pre></td></tr></table></figure>
见<a target="_blank" rel="noopener" href="https://docs.microsoft.com/zh-cn/dotnet/csharp/language-reference/tokens/interpolated">Mircrosoft Docs: C#字符串内插</a></li>
</ul>
<p>string list 分隔<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">String.Join(&quot;,&quot;, list)</span><br></pre></td></tr></table></figure></p>
<h4 id="IEnumerable-Select"><a href="#IEnumerable-Select" class="headerlink" title="IEnumerable.Select"></a>IEnumerable<T>.Select</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vm.children &#x3D; parentList.Select(parentItem &#x3D;&gt; parentItem.Child).ToList();</span><br></pre></td></tr></table></figure>
<h4 id="初始化Object"><a href="#初始化Object" class="headerlink" title="初始化Object"></a>初始化Object</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">result.data &#x3D;new &#123;</span><br><span class="line">        List &#x3D; itemList,</span><br><span class="line">        Total &#x3D; itemsTotal</span><br><span class="line"> &#125;;</span><br><span class="line"></span><br><span class="line">result &#x3D; await _context.OurBrand</span><br><span class="line">        .Where(brand &#x3D;&gt; brand.name !&#x3D; &quot;QQsIndustry&quot;)</span><br><span class="line">        .Select(brand&#x3D;&gt;new JObject&#123;&#123;&quot;name&quot;, brand.name&#125;, &#123;&quot;logo&quot;, brand.logo&#125;&#125;)</span><br><span class="line">        .ToListAsync();</span><br></pre></td></tr></table></figure>
<h4 id="正则表达式及其校验"><a href="#正则表达式及其校验" class="headerlink" title="正则表达式及其校验"></a>正则表达式及其校验</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">string pattern &#x3D; @&quot;^[A-Z]&#123;4&#125;[AB0-9][0-9]&#123;3&#125;$&quot;;</span><br><span class="line">flag &#x3D; Regex.IsMatch(sn, pattern)</span><br></pre></td></tr></table></figure>
<h4 id="HttpWebRequest"><a href="#HttpWebRequest" class="headerlink" title="HttpWebRequest"></a>HttpWebRequest</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">public async Task&lt;MyResult&gt; SendHttpRequestAsync(string uri, Object postData, string token)&#123;</span><br><span class="line">    </span><br><span class="line">    HttpWebRequest request &#x3D; WebRequest.CreateHttp(uri); &#x2F;&#x2F; TODO deal with exception</span><br><span class="line">    </span><br><span class="line">    request.Headers.Add(&quot;Authorization&quot;, string.Format(&quot;Bearer &#123;0&#125;&quot;, token));</span><br><span class="line">    request.ContentType &#x3D; @&quot;application&#x2F;json&quot;;</span><br><span class="line">    request.Method &#x3D; @&quot;Post&quot;;</span><br><span class="line">    request.Host &#x3D; GetHost(uri);</span><br><span class="line">    request.Timeout &#x3D; 60000;</span><br><span class="line"></span><br><span class="line">    byte[] data &#x3D; Encoding.UTF8.GetBytes(JsonUtility.ObjToJson(postData));</span><br><span class="line">    request.ContentLength &#x3D; data.Length;</span><br><span class="line"></span><br><span class="line">    using (var stream &#x3D; request.GetRequestStream())</span><br><span class="line">    &#123;</span><br><span class="line">        stream.Write(data, 0, data.Length);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    try&#123;</span><br><span class="line">        using (WebResponse response &#x3D; await request.GetResponseAsync())</span><br><span class="line">        &#123;</span><br><span class="line">            using (var receiveStream &#x3D; response.GetResponseStream())</span><br><span class="line">            &#123;</span><br><span class="line">                using (var reader &#x3D; new StreamReader(receiveStream)) &#x2F;&#x2F; TODO deal with System.ArgumentNullException</span><br><span class="line">                &#123;</span><br><span class="line">                    if (reader !&#x3D; null)</span><br><span class="line">                    &#123;</span><br><span class="line">                        var responseString &#x3D; System.Web.HttpUtility.HtmlDecode(reader.ReadToEnd().Trim());</span><br><span class="line">                        return JsonUtility.JsonToObj&lt;MyResult&gt;(response);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;catch(WebException ex)&#123;</span><br><span class="line">        string message;</span><br><span class="line">        WebResponse errorResponse &#x3D; ex.Response;</span><br><span class="line">        if (errorResponse !&#x3D; null)</span><br><span class="line">        &#123;</span><br><span class="line">            using (Stream responseStream &#x3D; errorResponse.GetResponseStream())</span><br><span class="line">            &#123;</span><br><span class="line">                StreamReader reader &#x3D; new StreamReader(responseStream, Encoding.GetEncoding(&quot;utf-8&quot;));</span><br><span class="line">                message &#x3D; reader.ReadToEnd();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;else&#123;</span><br><span class="line">            throw new Exception(&quot;Unknown&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>上例中的发送/接收用了流读写的方式，估计这也是所有封装Http请求的通用原理，注意catch块中对WebException的处理，这样可以看到服务端返回的所有信息，相当于用postman调用失败后看到的错误信息，比error code 或 ‘Bad Request’描述丰富<br>参考: <a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/692342/net-httpwebrequest-getresponse-raises-exception-when-http-status-code-400-ba">StackOverflow: HttpWebRequest 400 Bad Request</a>, <a target="_blank" rel="noopener" href="https://blog.csdn.net/zhruifei/article/details/78356347">HttpWebRequest详细用法</a></p>
<h4 id="文件接口"><a href="#文件接口" class="headerlink" title="文件接口"></a>文件接口</h4><p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/347734073">IFormFile</a></p>
<h4 id="Regex"><a href="#Regex" class="headerlink" title="Regex"></a>Regex</h4><p>email 地址校验前进行域名转码<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">try</span><br><span class="line">&#123;</span><br><span class="line">    email &#x3D; Regex.Replace(email, @&quot;(@)(.+)$&quot;, DomainMapper,</span><br><span class="line">                        RegexOptions.None, TimeSpan.FromMilliseconds(200));</span><br><span class="line"></span><br><span class="line">    &#x2F;&#x2F; Examines the domain part of the email and normalizes it.</span><br><span class="line">    string DomainMapper(Match match)</span><br><span class="line">    &#123;</span><br><span class="line">        &#x2F;&#x2F; Use IdnMapping class to convert Unicode domain names.</span><br><span class="line">        var idn &#x3D; new IdnMapping();</span><br><span class="line"></span><br><span class="line">        &#x2F;&#x2F; Pull out and process domain name (throws ArgumentException on invalid)</span><br><span class="line">        string domainName &#x3D; idn.GetAscii(match.Groups[2].Value);</span><br><span class="line"></span><br><span class="line">        return match.Groups[1].Value + domainName;</span><br><span class="line">    &#125;</span><br><span class="line">catch (RegexMatchTimeoutException e)</span><br><span class="line">&#123;</span><br><span class="line">    return false;</span><br><span class="line">&#125;</span><br><span class="line">catch (ArgumentException e)</span><br><span class="line">&#123;</span><br><span class="line">    return false;</span><br><span class="line">&#125;</span><br><span class="line">try</span><br><span class="line">&#123;</span><br><span class="line">    return Regex.IsMatch(email,</span><br><span class="line">        @&quot;^[^@\s]+@[^@\s]+\.[^@\s]+$&quot;,</span><br><span class="line">        RegexOptions.IgnoreCase, TimeSpan.FromMilliseconds(250));</span><br><span class="line">&#125;</span><br><span class="line">catch (RegexMatchTimeoutException)</span><br><span class="line">&#123;</span><br><span class="line">    return false;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br><a target="_blank" rel="noopener" href="https://docs.microsoft.com/zh-cn/dotnet/api/system.globalization.idnmapping.getascii?view=net-5.0">IdnMapping.GetAscii</a>:将包含 US-ASCII 字符范围以外的Unicode字符的域名称标签字符串编码为（U+0020 至 U+007E）内的可显示 Unicode 字符的字符串</p>
<h4 id="sealed-class"><a href="#sealed-class" class="headerlink" title="sealed class"></a>sealed class</h4><h4 id="catch-when"><a href="#catch-when" class="headerlink" title="catch when"></a><a target="_blank" rel="noopener" href="https://docs.microsoft.com/zh-cn/dotnet/csharp/language-reference/keywords/when">catch when</a></h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">try</span><br><span class="line">&#123;</span><br><span class="line">    await _dbContext.SaveChangesAsync();</span><br><span class="line">&#125;</span><br><span class="line">&#x2F;&#x2F; Is this error due to device SerialNumber constraint violation?</span><br><span class="line">catch (SqlUniqueConstraintViolationError ex) when (ex.Message.Contains(device.SerialNumber))</span><br><span class="line">&#123;</span><br><span class="line">    throw new DataException($&quot;A device with the same serial number (&#123;device.SerialNumber&#125;) already exist.&quot;, ex);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="Http-Request"><a href="#Http-Request" class="headerlink" title="Http Request"></a>Http Request</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><span class="line">using System.IO;</span><br><span class="line">using System.Net;</span><br><span class="line">using System.Net.Http;</span><br><span class="line">using System.Text;</span><br><span class="line">using System.Threading.Tasks;</span><br><span class="line">using QQsProj.Models;</span><br><span class="line"></span><br><span class="line">namespace QQsProj.Utilities</span><br><span class="line">&#123;</span><br><span class="line">    internal class HttpUtility</span><br><span class="line">    &#123;</span><br><span class="line">        public static async Task&lt;string&gt; DoHttpRequestAsync(string host, string uri, string postData,</span><br><span class="line">                                                        string contentType, HttpMethod method,</span><br><span class="line">                                                        string token)</span><br><span class="line">        &#123;</span><br><span class="line">            HttpWebRequest request &#x3D; CreateHttpRequest(host, uri, method, contentType, token);</span><br><span class="line">            if (request &#x3D;&#x3D; null)</span><br><span class="line">            &#123;</span><br><span class="line">                return string.Empty;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            request.Timeout &#x3D; 60000;</span><br><span class="line"></span><br><span class="line">            if (postData !&#x3D; null)</span><br><span class="line">            &#123;</span><br><span class="line">                byte[] byte1 &#x3D; Encoding.UTF8.GetBytes(postData);</span><br><span class="line">                request.ContentLength &#x3D; byte1.Length;</span><br><span class="line"></span><br><span class="line">                using (var stream &#x3D; request.GetRequestStream())</span><br><span class="line">                &#123;</span><br><span class="line">                    stream.Write(byte1, 0, byte1.Length);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            else</span><br><span class="line">            &#123;</span><br><span class="line">                request.ContentLength &#x3D; 0;</span><br><span class="line">            &#125;</span><br><span class="line">            try</span><br><span class="line">            &#123;</span><br><span class="line">                using (var response &#x3D; await request.GetResponseAsync())</span><br><span class="line">                &#123;</span><br><span class="line">                    using (var receiveStream &#x3D; response.GetResponseStream())</span><br><span class="line">                    &#123;</span><br><span class="line">                        using (var reader &#x3D; new StreamReader(receiveStream))</span><br><span class="line">                        &#123;</span><br><span class="line">                            if (reader !&#x3D; null)</span><br><span class="line">                            &#123;</span><br><span class="line">                                return System.Web.HttpUtility.HtmlDecode(reader.ReadToEnd().Trim());</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            catch (WebException ex)</span><br><span class="line">            &#123;</span><br><span class="line">                using (HttpWebResponse httpResponse &#x3D; (HttpWebResponse)ex.Response)</span><br><span class="line">                &#123;</span><br><span class="line">                    if (httpResponse !&#x3D; null &amp;&amp; httpResponse.StatusCode &#x3D;&#x3D; HttpStatusCode.Unauthorized)</span><br><span class="line">                    &#123;</span><br><span class="line">                        var strToken &#x3D; await EventManager.TokenExpired();</span><br><span class="line">                        return await DoHttpRequestAsync(null, uri, postData, contentType, method, strToken);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            return null;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        private static HttpWebRequest CreateHttpRequest(string host, string uri, HttpMethod method,</span><br><span class="line">                                                        string conentType, string token)</span><br><span class="line">        &#123;</span><br><span class="line">            HttpWebRequest request &#x3D; WebRequest.CreateHttp(uri);</span><br><span class="line">            if (!string.IsNullOrEmpty(token))</span><br><span class="line">            &#123;</span><br><span class="line">                request.Headers.Add(&quot;Authorization&quot;, string.Format(&quot;Bearer &#123;0&#125;&quot;, token));</span><br><span class="line">            &#125;</span><br><span class="line">            request.ContentType &#x3D; conentType;</span><br><span class="line">            request.Method &#x3D; method.ToString();</span><br><span class="line">            if (!string.IsNullOrEmpty(host))</span><br><span class="line">            &#123;</span><br><span class="line">                request.Host &#x3D; host;</span><br><span class="line">            &#125;****</span><br><span class="line"></span><br><span class="line">            return request;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="反序列化"><a href="#反序列化" class="headerlink" title="反序列化"></a>反序列化</h4><p>JsonUtility.cs<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">using System.IO;</span><br><span class="line">using System.Runtime.Serialization.Json;</span><br><span class="line">using System.Text;</span><br><span class="line"></span><br><span class="line">namespace QQsProj.Utilities</span><br><span class="line">&#123;</span><br><span class="line">    internal class JsonUtility</span><br><span class="line">    &#123;</span><br><span class="line">        public static string ObjToJson&lt;T&gt;(T obj)</span><br><span class="line">        &#123;</span><br><span class="line">            DataContractJsonSerializer serializer &#x3D; new DataContractJsonSerializer(obj.GetType());</span><br><span class="line">            string retVal &#x3D; string.Empty;</span><br><span class="line">            using (MemoryStream ms &#x3D; new MemoryStream())</span><br><span class="line">            &#123;</span><br><span class="line">                serializer.WriteObject(ms, obj);</span><br><span class="line">                retVal &#x3D; Encoding.UTF8.GetString(ms.ToArray());</span><br><span class="line">            &#125;</span><br><span class="line">            return retVal;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        public static T JsonToObj&lt;T&gt;(string json)</span><br><span class="line">        &#123;</span><br><span class="line">            T obj;</span><br><span class="line">            using (MemoryStream ms &#x3D; new MemoryStream(Encoding.Unicode.GetBytes(json)))</span><br><span class="line">            &#123;</span><br><span class="line">                DataContractJsonSerializer serializer &#x3D; new DataContractJsonSerializer(typeof(T));</span><br><span class="line">                obj &#x3D; (T)serializer.ReadObject(ms);</span><br><span class="line">            &#125;</span><br><span class="line">            return obj;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>调用：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">var res &#x3D; JsonUtility.JsonToObj&lt;List&lt;Account&gt;&gt;(response)</span><br></pre></td></tr></table></figure><br>其中Model.Account须标记属性如下<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">using System;</span><br><span class="line">using System.Runtime.Serialization;</span><br><span class="line"></span><br><span class="line">namespace QQsProj.Models</span><br><span class="line">&#123;</span><br><span class="line">    [DataContract]</span><br><span class="line">    public class Account</span><br><span class="line">    &#123;</span><br><span class="line">        [DataMember(Name &#x3D; &quot;name&quot;)]</span><br><span class="line">        public string Name &#123; get; set; &#125;</span><br><span class="line">        [DataMember(Name &#x3D; &quot;emailAddress&quot;)]</span><br><span class="line">        public string EmailAddress &#123; get; set; &#125;</span><br><span class="line">        [DataMember(Name &#x3D; &quot;logo&quot;)]</span><br><span class="line">        public string Logo &#123; get; set; &#125;</span><br><span class="line">        [DataMember(Name &#x3D; &quot;addressId&quot;)]</span><br><span class="line">        public string AddressId &#123; get; set; &#125;</span><br><span class="line">        [DataMember(Name &#x3D; &quot;recordId&quot;, EmitDefaultValue &#x3D; false)]</span><br><span class="line">        public string RecordId &#123; get; set; &#125;</span><br><span class="line">        [DataMember(Name &#x3D; &quot;recordStatus&quot;, EmitDefaultValue &#x3D; false)]</span><br><span class="line">        public string RecordStatus &#123; get; set; &#125;</span><br><span class="line">        &#x2F;&#x2F;[DataMember(Name &#x3D; &quot;recordCreated&quot;)]</span><br><span class="line">        public DateTime RecordCreated &#123; get; set; &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>DataMember注解使Model的属性可以与json属性相互转化，此处因为时间类型牵扯到格式问题偷懒注释掉DataMember以避免报错，亦可在get set中进行具体时间格式转换<br>EmitDefaultValue = false在Model转json时不自动初始化如”recordId”:null的键值对，以免于在接口中传输</p>
<p>服务调用OData API，用HttpWebRequest.GetResponseAsync获取的string反序列化为目标Model的list，定义：<br>ODataResponse.cs<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">using System.Runtime.Serialization;</span><br><span class="line"></span><br><span class="line">namespace QQsProj.Models</span><br><span class="line">&#123;</span><br><span class="line">    [DataContract]</span><br><span class="line">    public class ODataResponse&lt;T&gt;</span><br><span class="line">    &#123;</span><br><span class="line">        [DataMember(Name &#x3D; &quot;value&quot;)]</span><br><span class="line">        public T[] Value &#123; get; set; &#125;</span><br><span class="line">        [DataMember(Name &#x3D; &quot;odata.metadata&quot;)]</span><br><span class="line">        public string Metadata &#123; get; set; &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>调用:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">var responseObj &#x3D; JsonUtility.JsonToObj&lt;ODataResponse&lt;CsfpPartner&gt;&gt;(response);</span><br><span class="line">if (null !&#x3D; responseObj.Value &amp;&amp; responseObj.Value.Length&gt;0)</span><br><span class="line">&#123;</span><br><span class="line">    res &#x3D; responseObj.Value[0];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h4 id="volatile"><a href="#volatile" class="headerlink" title="volatile"></a>volatile</h4><p><a target="_blank" rel="noopener" href="https://docs.microsoft.com/zh-cn/dotnet/csharp/language-reference/keywords/volatile">Microsoft Docs 关键字</a></p>
<h4 id="nameof"><a href="#nameof" class="headerlink" title="nameof"></a>nameof</h4><p>返回变量名称的字符串</p>
<h4 id="泛型"><a href="#泛型" class="headerlink" title="泛型"></a>泛型</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">public static void foo&lt;T&gt;(T parameter)&#123;</span><br><span class="line">    Console.WriteLine(&quot;parameter&#x3D;&#123;0&#125; type is &#123;1&#125;&quot;, paramater.toString(), parameter.GetType().Name)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="IEnumerable-ICollection-IQeurable-List-T"><a href="#IEnumerable-ICollection-IQeurable-List-T" class="headerlink" title="IEnumerable ICollection IQeurable List T[]"></a>IEnumerable<T> ICollection<T> IQeurable<T> List<T> T[]</h4><p>IEnumerable是其他接口或实现的基类</p>
<blockquote>
<p>Exposes the enumerator, which supports a simple iteration over a collection of a specified type. 暴露enumerator，支持在指定类型的集合上进行简单迭代</p>
</blockquote>
<p>并不常用IEnumerable<T>声明变量，更多使用ICollection<T> 使用ToList方法IEnumerable<T>将其转换为ICollection<T>：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">public interface ICollection&lt;T&gt; : IEnumerable&lt;T&gt;, IEnumerable</span><br><span class="line"></span><br><span class="line">public interface IList&lt;T&gt; : ICollection&lt;T&gt;, IEnumerable&lt;T&gt;, IEnumerable</span><br><span class="line"> </span><br><span class="line">public class List&lt;T&gt; : IList&lt;T&gt;, ICollection&lt;T&gt;, IEnumerable&lt;T&gt;, IList, ICollection, IEnumerable</span><br></pre></td></tr></table></figure><br><img src="https://i0.wp.com/tvax2.sinaimg.cn/large/0032xJMSgy1gtdrfazvquj60dw07sdht02.jpg" alt=""></p>
<h4 id="Dictionary"><a href="#Dictionary" class="headerlink" title="Dictionary"></a>Dictionary</h4><p>面试问题</p>
<h4 id="函数柯里化"><a href="#函数柯里化" class="headerlink" title="函数柯里化"></a>函数柯里化</h4><p>js柯里化求和<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">const sum&#x3D;a&#x3D;&gt;b&#x3D;&gt;c&#x3D;&gt;(a+b+c) </span><br><span class="line">&#x2F;&#x2F; sum &#x3D; a &#x3D;&gt; (b &#x3D;&gt; (c &#x3D;&gt; (a+b+c))) </span><br><span class="line">sum(1)(1)(2)  &#x2F;&#x2F;res:4</span><br></pre></td></tr></table></figure><br>C#柯里化<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Func&lt;Int32, Func&lt;Int32, Int32&gt;&gt; sum &#x3D; x &#x3D;&gt; y &#x3D;&gt; x + y;</span><br><span class="line">Func&lt;Int32, Int32&gt; sumwith5 &#x3D; sum(5)</span><br></pre></td></tr></table></figure></p>
<h4 id="异步编程模式"><a href="#异步编程模式" class="headerlink" title="异步编程模式"></a>异步编程模式</h4><ul>
<li>基于任务(Task&lt;&gt;)的异步模式</li>
<li>基于事件的异步模式 XXAsync(object sender, EventArgs e)</li>
<li>IAsyncResult 模式（不建议）</li>
</ul>
<p>命名的惯例：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Task&lt;string&gt; GetAsync()&#123;&#125;</span><br><span class="line">Task BeginProcess()&#123;&#125;</span><br></pre></td></tr></table></figure></p>
<h4 id="多线程"><a href="#多线程" class="headerlink" title="多线程"></a>多线程</h4><p>创建线程和结束线程<br><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_39878688/article/details/111116800">wpf 关闭程序退出线程_多线程与高并发</a></p>
<ul>
<li>Application.Shutdown(exitCode) 或因线程未结束 无法返回正确的exitCode</li>
<li>System.Environment.Exit(exitCode) 强制关闭进程</li>
</ul>
<p>WhenAny WhenAll 类似响应式编程函数，分别为任意task返回、所有task返回，task的异常会抛出在相同层面 <a target="_blank" rel="noopener" href="https://learn.microsoft.com/zh-cn/dotnet/api/system.aggregateexception?view=net-7.0">AggregateException 类</a></p>
<h4 id="cancellationToken"><a href="#cancellationToken" class="headerlink" title="cancellationToken"></a>cancellationToken</h4><p>CancellationToken 线程取消信号 用于取消异步操作或长时间运行的同步操作<br>The cancellation token to which you should respond to. See <a target="_blank" rel="noopener" href="https://docs.microsoft.com/en-us/dotnet/standard/parallel-programming/task-cancellation">https://docs.microsoft.com/en-us/dotnet/standard/parallel-programming/task-cancellation</a> for details.</p>
<h4 id="线程安全"><a href="#线程安全" class="headerlink" title="线程安全"></a>线程安全</h4><p>通用类型很少整体上是线程安全的，原因如下：</p>
<ul>
<li>开发成本 全线程安全的开发负担可能会很大，特别是如果一个类型有很多字段（每个字段在任意多线程上下文中都是潜在的交互）。</li>
<li>可能会带来性能成本（无论该类型是否被多个线程实际使用，都需要付出一定的代价）。</li>
<li>线程安全类型并不一定会使使用它的程序成为线程安全的，并且通常后者涉及的工作使前者变得多余。<br>因此，线程安全通常在需要的地方实现，以便处理特定的多线程场景。<h4 id="lock"><a href="#lock" class="headerlink" title="lock"></a>lock</h4></li>
</ul>
<h4 id="委托Delegate"><a href="#委托Delegate" class="headerlink" title="委托Delegate"></a>委托Delegate</h4><blockquote>
<p>C# 中的委托（Delegate）类似于 C 或 C++ 中函数的指针, 是一种引用类型变量 </p>
</blockquote>
<p>作为函数方法的引用，委托用于将<strong>方法</strong>作为参数传给其他方法<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">public delegate int MethodDelegate(int x, int y)</span><br><span class="line">public int Add(int x, int y) &#123; return x + y;&#125;</span><br><span class="line"></span><br><span class="line">public static void Main(string[] args)&#123;</span><br><span class="line">    MethodDelegate method &#x3D; new MethodDelegate(Add);</span><br><span class="line">    Console.WriteLine(method(10, 20));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>委托可通过+ -运算符进行组合，多个方法组合的委托为<a target="_blank" rel="noopener" href="https://learn.microsoft.com/zh-cn/dotnet/csharp/programming-guide/delegates/how-to-combine-delegates-multicast-delegates">多播(multicast)委托</a></p>
<p>如将回调函数传给System.Timers.Timer构造函数<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">var timer &#x3D; new Timer(delegate &#123;</span><br><span class="line">    Dispatcher.Invoke(() &#x3D;&gt; &#123; lst.Add(DateTime.Now.ToString(); &#125;));</span><br><span class="line">&#125;, null, 3000, 1)</span><br></pre></td></tr></table></figure><br>其灵活性在于可以在既定的程序结构中更改函数方法的调用，类似于接口之于模块</p>
<p>Action\<T\> 和 Func\<T\><br>两个内置的泛型委托，唯一的区别在于Action没有范围值而Func必有返回值</p>
<p>事件是特殊的委托————变量委托<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">public delegate void DoSth(object sender, EventArgs e);</span><br><span class="line">public static event DoSth myDoSth;</span><br><span class="line">static void Print(object sender, EventArgs e)</span><br><span class="line">&#123;</span><br><span class="line">    Console.WriteLine(sender);</span><br><span class="line">&#125;</span><br><span class="line">...</span><br><span class="line">&#x2F;&#x2F; 注册事件响应</span><br><span class="line">DoSth d &#x3D; new DoSth(Print);</span><br><span class="line">object sender &#x3D; 10;</span><br><span class="line">EventArgs e &#x3D; new EventArgs();</span><br><span class="line">myDoSth +&#x3D; new DoSth(d);&#x2F;&#x2F;+&#x3D;委托（委托的实例化对象）</span><br><span class="line">myDoSth(sender, e);&#x2F;&#x2F;执行方法</span><br><span class="line">&#x2F;&#x2F;声明了事件myDoSth,事件的类型是DoSth这个委托</span><br><span class="line">&#x2F;&#x2F;通过 +&#x3D; 为事件注册委托</span><br><span class="line">&#x2F;&#x2F;通过DoSth委托的构造函数为事件注册委托实例</span><br><span class="line">&#x2F;&#x2F;采用委托变量(参数列表)这种形式，让事件执行方法</span><br></pre></td></tr></table></figure></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://qqstone.github.io/qqsnote/2020/07/27/dotNetCore-Middleware/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/qqsnote/images/avatar.gif">
      <meta itemprop="name" content="QQs">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="QQs'Note">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/qqsnote/2020/07/27/dotNetCore-Middleware/" class="post-title-link" itemprop="url">.Net Core 中间件</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2020-07-27 10:14:04" itemprop="dateCreated datePublished" datetime="2020-07-27T10:14:04+08:00">2020-07-27</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2021-06-16 21:02:49" itemprop="dateModified" datetime="2021-06-16T21:02:49+08:00">2021-06-16</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>这里的中间件概念和express.js中的是一致的,</p>
<p>下面栗子的代码来源： <a target="_blank" rel="noopener" href="https://juejin.im/entry/5b39c743e51d4558a21fad54">Net Core中间件封装原理示例demo解析</a><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">public static class RequestIpExtensions</span><br><span class="line">&#123;</span><br><span class="line">    public static IApplicationBuilder UseRequestIp(this IApplicationBuilder builder)</span><br><span class="line">    &#123;</span><br><span class="line">        return builder.UseMiddleware&lt;RequestIPMiddleware&gt;();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<blockquote>
<p>each middleware extension method is exposed on IApplicationBuilder through the Microsoft.AspNetCore.Builder namespace. 通过IApplicationBuilder接口方法引入中间件，IApplicationBuilder由Microsoft.AspNetCore.Builder命名空间提供</p>
</blockquote>
<p>中间件的具体实现<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">public class RequestIPMiddleware</span><br><span class="line">&#123;</span><br><span class="line">    private readonly RequestDelegate _next;</span><br><span class="line">    private readonly ILogger _logger;</span><br><span class="line"></span><br><span class="line">    public RequestIPMiddleware(RequestDelegate next, ILoggerFactory loggerFactory)</span><br><span class="line">    &#123;</span><br><span class="line">        _next &#x3D; next;</span><br><span class="line">        _logger &#x3D; loggerFactory.CreateLogger&lt;RequestIPMiddleware&gt;();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public async Task Invoke(HttpContext context)</span><br><span class="line">    &#123;</span><br><span class="line">        _logger.LogInformation(&quot;User Ip: &quot; + context.Connection.RemoteIpAddress.ToString());</span><br><span class="line">        await _next.Invoke(context);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>使用中间<br><br>Startup.cs<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">public void Configure(IApplicationBuilder app, IHostingEnvironment env)</span><br><span class="line">&#123;</span><br><span class="line">    ....</span><br><span class="line">    app.UseRequestIp();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://qqstone.github.io/qqsnote/2020/07/22/WebDev-OtherStories/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/qqsnote/images/avatar.gif">
      <meta itemprop="name" content="QQs">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="QQs'Note">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/qqsnote/2020/07/22/WebDev-OtherStories/" class="post-title-link" itemprop="url">WebDev_OtherStories</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2020-07-22 10:11:02" itemprop="dateCreated datePublished" datetime="2020-07-22T10:11:02+08:00">2020-07-22</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2021-06-16 21:02:49" itemprop="dateModified" datetime="2021-06-16T21:02:49+08:00">2021-06-16</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h4 id="js的特点"><a href="#js的特点" class="headerlink" title="js的特点"></a>js的特点</h4><blockquote>
<p>the part that is good is not original, and the part that is original is not good.</p>
</blockquote>
<h4 id="关于浏览器"><a href="#关于浏览器" class="headerlink" title="关于浏览器"></a>关于浏览器</h4><p><a target="_blank" rel="noopener" href="https://juejin.im/post/5aa5cb846fb9a028e25d2fb1">从url到页面显示</a></p>
<ul>
<li>“user agent stylesheet”用户代理样式，浏览器默认样式，无法在开发者模式中修改</li>
</ul>
<h4 id="js-事件"><a href="#js-事件" class="headerlink" title="js 事件"></a>js 事件</h4><ul>
<li>原生js并没有document.ready事件，<a target="_blank" rel="noopener" href="https://segmentfault.com/a/1190000016574288">document.ready和window.onload</a></li>
</ul>
<h4 id="前后端分离和SPA"><a href="#前后端分离和SPA" class="headerlink" title="前后端分离和SPA"></a>前后端分离和SPA</h4><p>显然前后端分离不一定非要做成SPA，但是SPA被认为是前后端分离的最佳实践：<br>前后端分离的初衷是对后台服务的优化，即将静态资源的传输移出后台逻辑，分离后前后端之间的接口只提供数据。<br><br>SPA的出现是“复用一切可复用”的设计原则的体现，即根据交互仅对局部视图更新，其他部分复用。<br><br>也就是说，SPA和前后端分离同样是解决可复用内容（包括页面模板）的问题，如果你的产品有必要做这个问题的优化，那么前后端分离和SPA就自然而然地成为选择。</p>
<h4 id="浏览器信息"><a href="#浏览器信息" class="headerlink" title="浏览器信息"></a>浏览器信息</h4><p>window.navigator.userAgent 参考<a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/API/NavigatorID/userAgent">MDN Web API</a><br>输出如 “Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/88.0.4324.104 Safari/537.36”<br>Caution! 该属性可修改 无法确保准确性</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://qqstone.github.io/qqsnote/2020/07/22/WebDev-RoadMap/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/qqsnote/images/avatar.gif">
      <meta itemprop="name" content="QQs">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="QQs'Note">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/qqsnote/2020/07/22/WebDev-RoadMap/" class="post-title-link" itemprop="url">Web开发学习路线</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2020-07-22 09:45:18" itemprop="dateCreated datePublished" datetime="2020-07-22T09:45:18+08:00">2020-07-22</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2024-06-15 16:30:40" itemprop="dateModified" datetime="2024-06-15T16:30:40+08:00">2024-06-15</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p><a target="_blank" rel="noopener" href="https://www.runoob.com/w3cnote/web-developer-learn-path.html">web开发学习路线图</a></p>
<p><a target="_blank" rel="noopener" href="https://juejin.im/post/5ea39c93f265da47e84e8c8a">https://juejin.im/post/5ea39c93f265da47e84e8c8a</a></p>
<p><a target="_blank" rel="noopener" href="http://www.ruanyifeng.com/blog/javascript/">阮一峰博客</a></p>
<h4 id="H5新增api"><a href="#H5新增api" class="headerlink" title="H5新增api"></a>H5新增api</h4><ul>
<li>navigator.geolocation.getCurrentPosition(successCallback, errorCallback)</li>
<li>dragable=true</li>
<li>FileReader</li>
<li>Storage</li>
<li>等</li>
</ul>
<h4 id="js单线程、异步和任务队列"><a href="#js单线程、异步和任务队列" class="headerlink" title="js单线程、异步和任务队列"></a>js单线程、异步和任务队列</h4><blockquote>
<p>避免修改dom引起的竞争</p>
<p>JavaScript是单线程的，可是浏览器内部不是单线程的。一些I/O操作、dom操作、定时器的计时和事件监听由浏览器提供的其他线程来完成的</p>
</blockquote>
<p><img src="https://user-gold-cdn.xitu.io/2018/6/13/163f6b033cff7849?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="任务机制"></p>
<p>对象放在heap（堆）里，常见的基础类型和函数放在stack（栈）里，函数执行的时候在栈里执行。其中会有异步操作，这些操作可能需要调用浏览器的其他线程去处理，操作结果由相应的回调函数响应，但是要先丢到任务队列中，等栈空了，则检查任务队列，将队列中的事件函数放到栈中执行。这个过程是循环不断地</p>
<p><a target="_blank" rel="noopener" href="https://www.zhihu.com/question/34499262">为什么函数调用是用栈实现的</a></p>
<h4 id="自查"><a href="#自查" class="headerlink" title="自查"></a>自查</h4><img  src=http://www.plantuml.com/plantuml/svg/dLJBJjj05DtdAsQT1G62qiUAHoELgc6H5Bf0B8mp0gV4jZmJ6dPf8H2NLrvK1QLOGKKOMkAc4YMD4xx6OpihVg4s3KZ6cKszik-vr_VSSsRkECACXDCSdqmpOY08ti95qicH_L80E4ym28YyQttNxhx-HUv3H6bRzTm3q0U3uEMRs6jFz1vn2hyTaOkoqQtugwOI2LfHQvqqSnImbvFDxNDog0AZSs4rTU3BUyWDWldvPOn5z3mKIcLWYkE7M3ua2WY78a_7nfuDXoDFHaSYe-7XiU6HC9YCnaYfIugxzjc6lRE-i42ZTpUGgPpQsWaWbLtIhfBEFYtvasfLTV_qAMQLGQp4YPXMkAUGu-rUvOQ2HnCH2eBNHFZersxOlDgtpmgES7uoPkkNgLJCMfiKVllHsqw1tEJj-Yd9vsyxilTWN3lHwySix_tjdMnOdS-sLdBjMe480SGYv4ybEtchKRUAcxoO1ckCn7jw62tTlFfWrZVDum7iuf1XQHfQSi6i_Q21JPqqZem_ibLLNDzBgbbJUkLpSbcaMRBLDGz-Ebuxzq4pkZMhgb8oup2PoVgvJl1BcHL6-X-syMmAKI1xww8_YBvXw0Cacij0hscjbaETj0TSojbf9mmc1G4ZB34YY34OIXopCZljaCSl8EAMU7_LUxWeCkmxu4md3ZXTLzksTW1UGOH1J62N6VVLsJymyB1nYdkFDuwjNTfgZcRwq0oaUJw1H1S5Ku84_OKpGX8EKPMCPtZCfI68ygkS9F1foDEwHBEY1Fj7sMsQTERXNCcmLsghMxBqcbVzoo_ae-gzcb_NUuT5KjuX3PdarS0uv9Fz1VqN>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/qqsnote/page/17/"><i class="fa fa-angle-left" aria-label="Previous page"></i></a><a class="page-number" href="/qqsnote/">1</a><span class="space">&hellip;</span><a class="page-number" href="/qqsnote/page/17/">17</a><span class="page-number current">18</span><a class="page-number" href="/qqsnote/page/19/">19</a><span class="space">&hellip;</span><a class="page-number" href="/qqsnote/page/32/">32</a><a class="extend next" rel="next" href="/qqsnote/page/19/"><i class="fa fa-angle-right" aria-label="Next page"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">QQs</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/qqsnote/archives/">
        
          <span class="site-state-item-count">317</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/qqsnote/categories/">
        <span class="site-state-item-count">20</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/qqsnote/tags/">
        <span class="site-state-item-count">117</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>



      </div>

      <div class="tag-cloud-tags">
        <a href="/qqsnote/tags/Net/" style="font-size: 30px; color: #fff">.Net</a> <a href="/qqsnote/tags/4G/" style="font-size: 12px; color: #ccc">4G</a> <a href="/qqsnote/tags/AI/" style="font-size: 21.82px; color: #e8e8e8">AI</a> <a href="/qqsnote/tags/Android/" style="font-size: 12px; color: #ccc">Android</a> <a href="/qqsnote/tags/Angular/" style="font-size: 30px; color: #fff">Angular</a> <a href="/qqsnote/tags/Apache/" style="font-size: 13.64px; color: #d1d1d1">Apache</a> <a href="/qqsnote/tags/Azure/" style="font-size: 26.73px; color: #f6f6f6">Azure</a> <a href="/qqsnote/tags/Babylon/" style="font-size: 12px; color: #ccc">Babylon</a> <a href="/qqsnote/tags/C/" style="font-size: 16.91px; color: #dadada">C#</a> <a href="/qqsnote/tags/C/" style="font-size: 16.91px; color: #dadada">C++</a> <a href="/qqsnote/tags/CSS/" style="font-size: 20.18px; color: #e3e3e3">CSS</a> <a href="/qqsnote/tags/DevOps/" style="font-size: 15.27px; color: #d5d5d5">DevOps</a> <a href="/qqsnote/tags/Docker/" style="font-size: 16.91px; color: #dadada">Docker</a> <a href="/qqsnote/tags/ES6/" style="font-size: 12px; color: #ccc">ES6</a> <a href="/qqsnote/tags/ESLint/" style="font-size: 12px; color: #ccc">ESLint</a> <a href="/qqsnote/tags/ElasticSearch/" style="font-size: 12px; color: #ccc">ElasticSearch</a> <a href="/qqsnote/tags/Electron/" style="font-size: 16.91px; color: #dadada">Electron</a> <a href="/qqsnote/tags/ElementUI/" style="font-size: 12px; color: #ccc">ElementUI</a> <a href="/qqsnote/tags/EntityFramework/" style="font-size: 13.64px; color: #d1d1d1">EntityFramework</a> <a href="/qqsnote/tags/Excel/" style="font-size: 12px; color: #ccc">Excel</a> <a href="/qqsnote/tags/FastDFS/" style="font-size: 12px; color: #ccc">FastDFS</a> <a href="/qqsnote/tags/Figma/" style="font-size: 12px; color: #ccc">Figma</a> <a href="/qqsnote/tags/Go/" style="font-size: 12px; color: #ccc">Go</a> <a href="/qqsnote/tags/GraphQL/" style="font-size: 12px; color: #ccc">GraphQL</a> <a href="/qqsnote/tags/Jasmine/" style="font-size: 12px; color: #ccc">Jasmine</a> <a href="/qqsnote/tags/Java/" style="font-size: 13.64px; color: #d1d1d1">Java</a> <a href="/qqsnote/tags/Jenkins/" style="font-size: 21.82px; color: #e8e8e8">Jenkins</a> <a href="/qqsnote/tags/Linux/" style="font-size: 23.45px; color: #ececec">Linux</a> <a href="/qqsnote/tags/MQ/" style="font-size: 12px; color: #ccc">MQ</a> <a href="/qqsnote/tags/Markdown/" style="font-size: 13.64px; color: #d1d1d1">Markdown</a> <a href="/qqsnote/tags/MongoDB/" style="font-size: 12px; color: #ccc">MongoDB</a> <a href="/qqsnote/tags/MySQL/" style="font-size: 12px; color: #ccc">MySQL</a> <a href="/qqsnote/tags/NSIS/" style="font-size: 12px; color: #ccc">NSIS</a> <a href="/qqsnote/tags/Nginx/" style="font-size: 12px; color: #ccc">Nginx</a> <a href="/qqsnote/tags/NoSQL/" style="font-size: 12px; color: #ccc">NoSQL</a> <a href="/qqsnote/tags/Node-js/" style="font-size: 18.55px; color: #dfdfdf">Node.js</a> <a href="/qqsnote/tags/OData/" style="font-size: 13.64px; color: #d1d1d1">OData</a> <a href="/qqsnote/tags/OpenCV/" style="font-size: 18.55px; color: #dfdfdf">OpenCV</a> <a href="/qqsnote/tags/PHP/" style="font-size: 12px; color: #ccc">PHP</a> <a href="/qqsnote/tags/PWA/" style="font-size: 12px; color: #ccc">PWA</a> <a href="/qqsnote/tags/Python/" style="font-size: 25.09px; color: #f1f1f1">Python</a> <a href="/qqsnote/tags/React/" style="font-size: 21.82px; color: #e8e8e8">React</a> <a href="/qqsnote/tags/SQL/" style="font-size: 12px; color: #ccc">SQL</a> <a href="/qqsnote/tags/SQL-Server/" style="font-size: 15.27px; color: #d5d5d5">SQL_Server</a> <a href="/qqsnote/tags/ServiceWorker/" style="font-size: 12px; color: #ccc">ServiceWorker</a> <a href="/qqsnote/tags/Shell/" style="font-size: 12px; color: #ccc">Shell</a> <a href="/qqsnote/tags/TypeScript/" style="font-size: 13.64px; color: #d1d1d1">TypeScript</a> <a href="/qqsnote/tags/UE/" style="font-size: 12px; color: #ccc">UE</a> <a href="/qqsnote/tags/UI/" style="font-size: 12px; color: #ccc">UI</a> <a href="/qqsnote/tags/UML/" style="font-size: 12px; color: #ccc">UML</a> <a href="/qqsnote/tags/Virtualbox/" style="font-size: 12px; color: #ccc">Virtualbox</a> <a href="/qqsnote/tags/WPF/" style="font-size: 12px; color: #ccc">WPF</a> <a href="/qqsnote/tags/WebGL/" style="font-size: 20.18px; color: #e3e3e3">WebGL</a> <a href="/qqsnote/tags/WebService/" style="font-size: 12px; color: #ccc">WebService</a> <a href="/qqsnote/tags/Web%E5%8D%8F%E8%AE%AE/" style="font-size: 12px; color: #ccc">Web协议</a> <a href="/qqsnote/tags/Web%E5%BC%80%E5%8F%91/" style="font-size: 26.73px; color: #f6f6f6">Web开发</a> <a href="/qqsnote/tags/Wechat/" style="font-size: 12px; color: #ccc">Wechat</a> <a href="/qqsnote/tags/object-Object/" style="font-size: 12px; color: #ccc">[object Object]</a> <a href="/qqsnote/tags/aigc/" style="font-size: 12px; color: #ccc">aigc</a> <a href="/qqsnote/tags/auth/" style="font-size: 12px; color: #ccc">auth</a> <a href="/qqsnote/tags/axios/" style="font-size: 12px; color: #ccc">axios</a> <a href="/qqsnote/tags/canvas/" style="font-size: 12px; color: #ccc">canvas</a> <a href="/qqsnote/tags/css/" style="font-size: 12px; color: #ccc">css</a> <a href="/qqsnote/tags/express/" style="font-size: 12px; color: #ccc">express</a> <a href="/qqsnote/tags/ftp/" style="font-size: 12px; color: #ccc">ftp</a> <a href="/qqsnote/tags/git/" style="font-size: 13.64px; color: #d1d1d1">git</a> <a href="/qqsnote/tags/hexo/" style="font-size: 12px; color: #ccc">hexo</a> <a href="/qqsnote/tags/http/" style="font-size: 12px; color: #ccc">http</a> <a href="/qqsnote/tags/https/" style="font-size: 12px; color: #ccc">https</a> <a href="/qqsnote/tags/ionic/" style="font-size: 12px; color: #ccc">ionic</a> <a href="/qqsnote/tags/javascript/" style="font-size: 28.36px; color: #fafafa">javascript</a> <a href="/qqsnote/tags/k8s/" style="font-size: 12px; color: #ccc">k8s</a> <a href="/qqsnote/tags/login/" style="font-size: 12px; color: #ccc">login</a> <a href="/qqsnote/tags/loopback/" style="font-size: 12px; color: #ccc">loopback</a> <a href="/qqsnote/tags/npm/" style="font-size: 12px; color: #ccc">npm</a> <a href="/qqsnote/tags/nsis/" style="font-size: 13.64px; color: #d1d1d1">nsis</a> <a href="/qqsnote/tags/redis/" style="font-size: 12px; color: #ccc">redis</a> <a href="/qqsnote/tags/sqlServer/" style="font-size: 12px; color: #ccc">sqlServer</a> <a href="/qqsnote/tags/ssh/" style="font-size: 12px; color: #ccc">ssh</a> <a href="/qqsnote/tags/svg/" style="font-size: 12px; color: #ccc">svg</a> <a href="/qqsnote/tags/vtk/" style="font-size: 16.91px; color: #dadada">vtk</a> <a href="/qqsnote/tags/vuejs/" style="font-size: 16.91px; color: #dadada">vuejs</a> <a href="/qqsnote/tags/webassembly/" style="font-size: 13.64px; color: #d1d1d1">webassembly</a> <a href="/qqsnote/tags/webpack/" style="font-size: 12px; color: #ccc">webpack</a> <a href="/qqsnote/tags/websocket/" style="font-size: 12px; color: #ccc">websocket</a> <a href="/qqsnote/tags/windows/" style="font-size: 12px; color: #ccc">windows</a> <a href="/qqsnote/tags/yarn/" style="font-size: 12px; color: #ccc">yarn</a> <a href="/qqsnote/tags/%E4%B8%8A%E4%BC%A0/" style="font-size: 12px; color: #ccc">上传</a> <a href="/qqsnote/tags/%E5%8A%A0%E5%AF%86/" style="font-size: 16.91px; color: #dadada">加密</a> <a href="/qqsnote/tags/%E5%8C%BB%E5%AD%A6%E5%9B%BE%E5%83%8F/" style="font-size: 12px; color: #ccc">医学图像</a> <a href="/qqsnote/tags/%E5%8D%8F%E8%AE%AE%E5%92%8C%E8%A7%84%E8%8C%83/" style="font-size: 12px; color: #ccc">协议和规范</a> <a href="/qqsnote/tags/%E5%8D%9A%E5%BC%88%E8%AE%BA/" style="font-size: 12px; color: #ccc">博弈论</a> <a href="/qqsnote/tags/%E5%9B%BE%E5%83%8F%E5%A4%84%E7%90%86/" style="font-size: 13.64px; color: #d1d1d1">图像处理</a> <a href="/qqsnote/tags/%E5%9B%BE%E5%BD%A2%E5%AD%A6/" style="font-size: 15.27px; color: #d5d5d5">图形学</a> <a href="/qqsnote/tags/%E5%A4%9A%E8%AF%AD%E8%A8%80/" style="font-size: 13.64px; color: #d1d1d1">多语言</a> <a href="/qqsnote/tags/%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B/" style="font-size: 12px; color: #ccc">存储过程</a> <a href="/qqsnote/tags/%E6%80%A7%E8%83%BD/" style="font-size: 12px; color: #ccc">性能</a> <a href="/qqsnote/tags/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/" style="font-size: 12px; color: #ccc">性能优化</a> <a href="/qqsnote/tags/%E6%88%90%E9%95%BF%E6%80%9D%E7%BB%B4/" style="font-size: 12px; color: #ccc">成长思维</a> <a href="/qqsnote/tags/%E6%91%84%E5%BD%B1/" style="font-size: 12px; color: #ccc">摄影</a> <a href="/qqsnote/tags/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/" style="font-size: 12px; color: #ccc">操作系统</a> <a href="/qqsnote/tags/%E6%95%B0%E5%AD%97%E7%AD%BE%E5%90%8D/" style="font-size: 12px; color: #ccc">数字签名</a> <a href="/qqsnote/tags/%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96/" style="font-size: 12px; color: #ccc">数据可视化</a> <a href="/qqsnote/tags/%E6%95%B0%E6%8D%AE%E5%BA%93%E9%94%81/" style="font-size: 12px; color: #ccc">数据库锁</a> <a href="/qqsnote/tags/%E6%A0%91%E8%8E%93%E6%B4%BE/" style="font-size: 12px; color: #ccc">树莓派</a> <a href="/qqsnote/tags/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/" style="font-size: 12px; color: #ccc">正则表达式</a> <a href="/qqsnote/tags/%E7%89%A9%E8%81%94%E7%BD%91/" style="font-size: 12px; color: #ccc">物联网</a> <a href="/qqsnote/tags/%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F/" style="font-size: 13.64px; color: #d1d1d1">环境变量</a> <a href="/qqsnote/tags/%E7%AE%97%E6%B3%95/" style="font-size: 15.27px; color: #d5d5d5">算法</a> <a href="/qqsnote/tags/%E7%BC%96%E7%A0%81%E8%A7%84%E8%8C%83/" style="font-size: 12px; color: #ccc">编码规范</a> <a href="/qqsnote/tags/%E8%A7%86%E9%A2%91%E6%B5%81/" style="font-size: 12px; color: #ccc">视频流</a> <a href="/qqsnote/tags/%E8%A7%A6%E5%8F%91%E5%99%A8/" style="font-size: 12px; color: #ccc">触发器</a> <a href="/qqsnote/tags/%E8%AE%A4%E8%AF%81-%E6%8E%88%E6%9D%83/" style="font-size: 21.82px; color: #e8e8e8">认证&授权</a> <a href="/qqsnote/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/" style="font-size: 12px; color: #ccc">设计模式</a> <a href="/qqsnote/tags/%E8%AF%BB%E4%B9%A6/" style="font-size: 12px; color: #ccc">读书</a> <a href="/qqsnote/tags/%E8%BF%9B%E7%A8%8B%E5%AE%88%E6%8A%A4/" style="font-size: 12px; color: #ccc">进程守护</a> <a href="/qqsnote/tags/%E9%9D%A2%E8%AF%95/" style="font-size: 13.64px; color: #d1d1d1">面试</a>
      </div>
    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2025</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">QQs</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://muse.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a>
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/qqsnote/lib/anime.min.js"></script>
  <script src="/qqsnote/lib/velocity/velocity.min.js"></script>
  <script src="/qqsnote/lib/velocity/velocity.ui.min.js"></script>

<script src="/qqsnote/js/utils.js"></script>

<script src="/qqsnote/js/motion.js"></script>


<script src="/qqsnote/js/schemes/muse.js"></script>


<script src="/qqsnote/js/next-boot.js"></script>




  















  

  

  

</body>
</html>
